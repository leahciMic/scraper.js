VaultState={},function(){var e=null,t=null,n=null,i=null,o=null,c=null,s=null,l=function(e){if(LPTools.getOption(e,"incrementAccountsVersion",!1)){var t=LPTools.getOption(e,"incrementAccountsVersionAmount",1);n+=t}};Topics.get(Topics.INITIALIZED).subscribe(function(){a()}),Topics.get(Topics.IDENTITY_ENABLE).subscribe(function(e){t=e.getID()}),Topics.get(Topics.REQUEST_SUCCESS).subscribe(function(e){l(e.requestSuccessOptions)}),Topics.get(Topics.UPDATE_VAULT_STATE).subscribe(l);var g=function(){if(bg.get("lploggedin")){if(c&&bg.get("g_identity")!==t){t=bg.get("g_identity");for(var e=0,l=c.length;e<l;++e)t===c[e].getID()&&c[e].enable({reprompt:!1})}var g=parseInt(bg.get("g_local_accts_version"));g>n?(n=g,Topics.get(Topics.REFRESH_DATA).publish(),o=null):n>g?(null===o&&(o=(new Date).getTime()),(new Date).getTime()-o>15e3&&(o=null,n=g)):o=null,i!==bg.get("g_showcredmon")&&(i=bg.get("g_showcredmon"),Topics.get(Topics.REFRESH_PREFERENCES).publish())}else Topics.get(Topics.CLEAR_DATA).publish(),clearInterval(s),s=setInterval(function(){r()},1e3)};VaultState.incrementAccountsVersion=function(){++n},VaultState.setAccountsVersion=function(e){n=e},VaultState.setIdentities=function(e){c=e};var u=function(){return bg&&bg.get("lploggedin")&&parseInt(bg.get("g_local_accts_version"))>-1&&LPPlatform.loadedPreferences()},r=function(o){return!!u()&&(e=bg.get("lploggedin"),t=bg.get("g_identity"),n=parseInt(bg.get("g_local_accts_version")),i=bg.get("g_showcredmon"),Topics.get(Topics.LOGIN).publish({fadeIn:void 0===o||o}),clearInterval(s),s=setInterval(function(){g()},1e3),!0)},a=function(){r(!1)||(s=setInterval(function(){r()},1e3))}}();