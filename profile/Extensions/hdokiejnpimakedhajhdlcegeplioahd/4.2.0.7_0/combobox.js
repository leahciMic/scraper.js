function openCombo(e,t,o){var i=document.getElementById(t);if(!i.disabled){gComboEx=document.getElementById(o);var l=gComboEx;"block"==l.style.display?(setStyle(l,"display","none",""),gItemNum=-1):(showCombo(i,l),gItemNum=-1),gFocusItem=i,setTimeout(function(){doFocus()},0)}}function showCombo(e,t){g_iField=e,g_cb=t,e.addEventListener("move",function(e){realShowCombo()},!1),realShowCombo()}function getY(e){for(var t=0;null!=e;)t+=e.offsetTop,e=e.offsetParent;return t}function getX(e){for(var t=0;null!=e;)t+=e.offsetLeft,e=e.offsetParent;return t}function realShowCombo(){var e=getY(g_iField),t=getX(g_iField),o=e+g_iField.offsetHeight+"px",i=t+"px";g_cb.style.minWidth=g_iField.offsetWidth+"px",setStyle(g_cb,"top",o,""),setStyle(g_cb,"left",i,""),setStyle(g_cb,"display","block","")}function focusCombo(e,t,o){var i=e.keyCode,l=!0;gComboEx=document.getElementById(o);var n=gComboEx;if(i==KEY_DOWN||i==KEY_F4){l=!1;"block"==n.getAttribute("style.display")||showCombo(t,n);for(var s=n.childNodes,d=s.length,m=0;null!=s[m]&&m<d;){if(s[m].nodeType==ELEMENT_NODE&&"item"==s[m].className){gFocusItem=s[m];break}m++}gItemNum=0,setTimeout(function(){doFocus()},0),l=!1}else i==KEY_ENTER||i==KEY_ESCAPE&&(null!=t.val&&t.val.length>0?l=!0:(l=!1,setStyle(gComboEx,"display","none",""),gItemNum=-1));return l}function focusItem(e,t,o){for(var i=o.val,l=null,n=getItems(t),s=n.length,d=!1,m=0;m<s;m++)if(n[m].hasChildNodes()&&n[m].firstChild.nodeValue==i){d=!0,l=n[m],gItemNum=m;break}if(d||(l=addItem(t,i,n.length),gItemNum=n.length),null!=l){if(gFocusItem=l,"block"!=gComboEx.getAttribute("style.display")){var a=o.offsetTop+o.offsetHeight+"px",u=o.offsetLeft+"px";setStyle(t,"top",a,""),setStyle(t,"left",u,"")}else setStyle(t,"display","none","");setStyle(t,"display","block",""),setTimeout(function(){doFocus()},0)}}function addItem(e,t,o,i){i||(i=document);var l=i.createElement("div"),n=void 0!==t.label?t.label:t,s=void 0!==t.label?t.value:t;if(l.val=s,l.label=n,void 0!==t.label&&(l.label=t.label,void 0!==t.image)){var d=i.createElement("img");d.src=t.image,d.style.paddingRight="15px",l.appendChild(d),l.img=d.src}var m=i.createTextNode(n);return l.appendChild(m),l.setAttribute("tabindex","-1"),l.setAttribute("class","item"),l.setAttribute("data-lpcount",o),l.addEventListener("click",function(){gItemNum=this.getAttribute("data-lpcount")}),l.addEventListener("mouseover",function(){gFocusItem=this,doFocus()}),l.setAttribute("role","listitem"),l.style.overflow="hidden",e.appendChild(l),l}function doComboNav(e,t,o){var i=e.keyCode,l=!0;if(null==gComboEx&&(gComboEx=t),i==KEY_UP||i==KEY_DOWN){l=!1;var n=0,s=getItems(gComboEx),d=s.length;i==KEY_UP?n=gItemNum-1:(n=gItemNum+1)==d&&(n=-1),gItemNum=n,gFocusItem=-1==gItemNum?document.getElementById(o):s[n],setTimeout(function(){doFocus()},0)}else if(i==KEY_ENTER||!e.keyCode&&e.button>=0){var s=getItems(gComboEx),m=s[gItemNum];if(null!=m&&"true"!=m.getAttribute("aria-disabled")){var a=m.label,u=m.val,c=document.getElementById(o);c.value=a,c.val=u,void 0!==m.img&&(c.style.background="url("+m.img+") no-repeat 2px 5px",c.style.paddingLeft="25px"),c.onchange&&c.onchange(),setStyle(gComboEx,"display","none",""),gItemNum=0,gFocusItem=c,setTimeout(function(){doFocus()},0)}}else i==KEY_ESCAPE&&(l=!1,setStyle(t,"display","none",""),gItemNum=0,gFocusItem=document.getElementById(o),setTimeout(function(){doFocus()},0));return l}function getItems(e){for(var t=new Array,t=new Array,o=e.childNodes,i=o.length,l=0;l<i;l++)o[l].nodeType!=ELEMENT_NODE||"item"!=o[l].getAttribute("class")&&"item focus"!=o[l].getAttribute("class")||(t[t.length]=o[l]);return t}function setStyle(e,t,o,i){var l=!1;try{e.style&&e.style.setProperty&&(e.style.setProperty(t,o,i),l=!0)}catch(e){alert("exception caught setting style: "+e.message)}if(!l)try{e.style[t]=o,l=!0}catch(e){alert("exception caught setting direct style: "+e.message)}return l}function doFocus(){null!=gFocusItem&&(gFocusItem.focus(),gLastFocusItem&&"item focus"==gLastFocusItem.className&&(gLastFocusItem.className="item"),gFocusItem&&"item"==gFocusItem.className&&(gFocusItem.className="item focus"),gLastFocusItem=gFocusItem,gFocusItem=null)}function create_combo(e,t,o,i,l){i||(i=document),l||(l="");var n=i.getElementById(e),s=e+"_combo";if(!i.getElementById(s)){n.onkeydown=function(e){return focusCombo(e,this,this.id+"_combo")},n.setAttribute("role","textfield"),n.setAttribute("aria-haspopup","true"),n.setAttribute("autocomplete","off"),n.style.marginRight="0px";var d=n.style.width.replace(/px/,"");if(""==d)try{d=n.ownerDocument.defaultView.getComputedStyle(n,"").width.replace(/px/,"")}catch(e){}var m=i.createElement(l+"div");m.setAttribute("role","list"),m.style.display="none",m.setAttribute("id",s),m.setAttribute("class","dropStyle"),m.onkeydown=function(e){return doComboNav(e,this,this.id.substring(0,this.id.length-6))},m.addEventListener("click",function(e){doComboNav(e,this,this.id.substring(0,this.id.length-6))}),m.style.paddingLeft="6px",m.style.paddingRight="6px",m.style.position="absolute",void 0!==i.body&&i.body?i.body.appendChild(m):i.getElementById("main").appendChild(m),n.ownerDocument.defaultView.addEventListener("click",function(){close_combo(e,i)},!1);for(var a=0;a<t.length;a++)addItem(m,t[a],a,i);var u=i.createElement(l+"img");u.id=e+"_button",u.onclick=function(e){openCombo(e,this.id.substring(0,this.id.length-7),this.id.substring(0,this.id.length-7)+"_combo"),e.cancelBubble=!0};var c=("undefined"==typeof gLocalBaseUrl?"":gLocalBaseUrl)+"images/pwdrop.png";if("undefined"!=typeof g_isie&&g_isie&&(c="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyNzRGRTU3Q0E0MEExMUUwOTJDNjk3MDYyMDFDNUI4RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoyNzRGRTU3REE0MEExMUUwOTJDNjk3MDYyMDFDNUI4RSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjVFMTE0Q0M3QTQwOTExRTA5MkM2OTcwNjIwMUM1QjhFIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjVFMTE0Q0M4QTQwOTExRTA5MkM2OTcwNjIwMUM1QjhFIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+I6ppiQAAAZhJREFUeNq0lc8rhEEcxve1m4sfB+IgFFk32oui9kDZiz1Jb36Ui4MLOSgcnNQWN7LlKJSD9kI4yUnKCVc54B/YZLc44PWZmrfeppl53zb71KfpffvO8z47890Zx/O8WDWUCD4UCgVdTQMMwCykoA3e4RXO4RJerMYadcMhDCq1rdALo7AmOYEfv6DGYroIT5C2BBDz2+EYzqA5zHgFdiP8oqCycmnqTcbDsAVOBXs2BHs6Y2F2FLJEYZqGjGowAR3/0GkLCc2GBVWEpOu6RZMLLdrH8ADxwOsRNXFSeW6CXEjCTcVUqFE1rtNMnCdVypA2K7tB24dhEmnyGtNahp2YpcGDKhnq0hjNKO+WoSeq8bMleU6mFGlbGNYttR+qcd5S3CVTCm34/zCDrp3gsSlPtzfoNEwow5Q8F+KGml8Y022eWMtvwySR8sJiKrQPVzrjW1iFSm6AG1gSqU3ttg1z8BXR0JPnsejpz7A+PoB+OPWLDYaPMCkPn1LUG0S037jcTPGRjFxnsUF3cC9ryupEp1qX6Z8AAwCnLFoADB2D+gAAAABJRU5ErkJggg=="),u.setAttribute("src",c),u.setAttribute("valign","middle"),"undefined"!=typeof g_isopera&&g_isopera&&(u.style.position="relative",u.style.top="7px"),n.nextSibling?n.parentNode.insertBefore(u,n.nextSibling):n.parentNode.appendChild(u),o&&"undefined"!=typeof getAbsolutePos){var r=getAbsolutePos(i,n);if(null!=r&&r.left>0&&r.top>0){var g;g=r.left+r.width-2-22,u.style.left=g+"px",u.style.position="absolute"}var b=Math.floor((22-r.height)/2);b>=1&&r.height<22&&(u.style.height=r.height+"px",u.style.width=r.height+"px",u.style.top=r.top+b+"px",g=r.left+r.width-2-22+b,u.style.left=g+"px");var p=Math.round((r.height-22)/2);r.height>22&&(u.style.top=r.top+p+"px"),n.style.paddingRight="24px",n.style.textOverflow="ellipsis",n.style.whiteSpace="nowrap",n.style.overflow="hidden"}}}function delete_combo_item(e,t){var o=e+"_combo",i=document.getElementById(o);if(i)for(var l=getItems(i),n=0;n<l.length;n++)if(l[n].innerHTML==t){for(l.splice(n,1);i.hasChildNodes();)i.removeChild(i.firstChild);for(var s=0;s<l.length;s++)addItem(i,l[s].innerHTML,s);break}}function close_combo(e,t){t||(t=document);var o=e+"_combo",i=t.getElementById(o);if(i){"block"==i.style.display&&(setStyle(i,"display","none",""),gItemNum=-1)}}function repopulate_combo(e,t,o){o||(o=document);var i=e+"_combo",l=o.getElementById(i);if(l){for(;l.hasChildNodes();)l.removeChild(l.firstChild);for(var n=0;n<t.length;n++)addItem(l,t[n],n,o)}}function destroy_combo(e,t){if(t||(t=document),!(null==e||e.length<=0))try{var o=e+"_combo",i=t.getElementById(o);if(i){for(;i.hasChildNodes();)i.removeChild(i.firstChild);i.parentNode.removeChild(i)}var l=e+"_button",n=t.getElementById(l);n&&n.parentNode.removeChild(n)}catch(e){console.log("destroy_combo error: "+e.message)}}var KEY_UP=38,KEY_DOWN=40,KEY_ENTER=13,ELEMENT_NODE=1,KEY_ESCAPE=27,KEY_F4=115,g_iField=null,g_cb=null,gItemNum=0,gComboEx=null,gFocusItem=null,gLastFocusItem=null;