"use strict";function handlerMatch(e,t){return!(!t||!t.matches.test(e))}function getMatchingHandler(e){return handlers.filter(function(t){return handlerMatch(e,t)}).shift()}function addAddressBarSearch(e){function t(){if(!o()){var e="",t=getMatchingHandler(u.value);t&&t.icon&&(e=t.icon),r(e)}}function n(e){u.setAttribute("autocompletesearch",e),u.mSearchNames=null,"function"==typeof u.initSearchNames&&u.initSearchNames()}var r,o,u,c=makeWindowHelpers(e).change,a=e.BrowserUI,i=e.gBrowser,l=e.gURLBar;if(null==i?void 0!==a&&(r=function(e){return a._updateIcon(e)},o=function(){return!1},u=a._edit,listen(e,a._edit,"input",t),c(e.Browser,"getShortcutOrURI",function(e){return function(t,n){return e.call(this,t,n)}})):(r=function(e){},o=function(){return"valid"==l.getAttribute("pageproxystate")&&!l.hasAttribute("focused")},u=l,listen(e,l,"input",t),listen(e,i.tabContainer,"TabSelect",t),c(l,"_canonizeURL",function(e){return function(t,n){return e.call(this,t,n)}})),void 0!==u){var s=u.getAttribute("autocompletesearch");n(self.id+" "+s),unload(function(){return n(s)})}}function addAutocomplete(){function e(){null!=t&&clearTimeout(t),t=null}var t,n="@mozilla.org/autocomplete/search;1?name="+self.id,r=g_chrome.components.ID("504A8466-8D3D-11E0-A57E-D2F94824019B"),o={createInstance:function(e,t){return o.QueryInterface(t)},QueryInterface:XPCOMUtils.generateQI([g_chrome.Ci.nsIAutoCompleteSearch]),startSearch:function(n,r,u,c){function a(e,t){c.onSearchResult(o,{getCommentAt:function(t){return e[t].title},getImageAt:function(t){return e[t].favicon},getLabelAt:function(t){return e[t].label||e[t].url},getValueAt:function(t){return e[t].url},getStyleAt:function(){return"favicon"},get matchCount(){return e.length},QueryInterface:XPCOMUtils.generateQI([g_chrome.Ci.nsIAutoCompleteResult]),removeValueAt:function(){},searchResult:g_chrome.Ci.nsIAutoCompleteResult.RESULT_SUCCESS,get searchString(){return n}})}if(e(),n.length){var i=getMatchingHandler(n);i&&n&&i.onSearch(n,a)}else t=setTimeout(function(){c.onSearchResult(o,{searchResult:g_chrome.Ci.nsIAutoCompleteResult.RESULT_NOMATCH})},1e3)},stopSearch:function(){e()}},u=g_chrome.Ci.nsIComponentRegistrar;g_chrome.Cm.QueryInterface(u).registerFactory(r,"LastPass Autocomplete",n,o),unload(function(){g_chrome.Cm.QueryInterface(u).unregisterFactory(r,o)})}function makeWindowHelpers(e){function t(t,n,r){if(t){var o=t[n];t[n]="function"==typeof r?r(o):r,unload(function(){return t[n]=o},e)}}return{change:t}}var WindowTracker=g_deprecated_window_utils.WindowTracker,self=g_self;g_chrome.Cu.import("resource://gre/modules/XPCOMUtils.jsm",this);var handlers=[];AwesomeBarSuggestion=function(e){var t=handlers.push(e)-1,n=!1;return{destroy:function(){n||(n=!0,handlers[t]=null)}}},WindowTracker({onTrack:addAddressBarSearch}),addAutocomplete();