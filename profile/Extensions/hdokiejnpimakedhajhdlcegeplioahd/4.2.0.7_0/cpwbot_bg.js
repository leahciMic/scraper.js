function replace_constants(e){if(!e)return null;if(void 0!==e.field_info)for(var t=0;t<e.field_info.length;t++){if(void 0!==e.field_info[t].id_type)switch(e.field_info[t].id_type){case"TYPE_ID":e.field_info[t].id_type=TYPE_ID;break;case"TYPE_NAME":e.field_info[t].id_type=TYPE_NAME;break;case"TYPE_XPATH":e.field_info[t].id_type=TYPE_XPATH}if(void 0!==e.field_info[t].id_function)switch(e.field_info[t].id_function){case"FN_LOGIN":e.field_info[t].id_function=FN_LOGIN;break;case"FN_PASSWORD":e.field_info[t].id_function=FN_PASSWORD;break;case"FN_LOGIN_OTHER":e.field_info[t].id_function=FN_LOGIN_OTHER;break;case"FN_CURRENT_PASS":e.field_info[t].id_function=FN_CURRENT_PASS;break;case"FN_NEW_PASS":e.field_info[t].id_function=FN_NEW_PASS;break;case"FN_NEW_PASS_CONFIRM":e.field_info[t].id_function=FN_NEW_PASS_CONFIRM;break;case"FN_CPW_OTHER":e.field_info[t].id_function=FN_CPW_OTHER;break;case"FN_CPW_INVALID":e.field_info[t].id_function=FN_CPW_INVALID;break;case"FN_LOGIN_INVALID":e.field_info[t].id_function=FN_LOGIN_INVALID;break;case"FN_LOGIN_SUCCESS":e.field_info[t].id_function=FN_LOGIN_SUCCESS;break;case"FN_LOGIN_SUCCESS_INVALID":e.field_info[t].id_function=FN_LOGIN_SUCCESS_INVALID;break;case"FN_NAVIGATE_TO_CPW":e.field_info[t].id_function=FN_NAVIGATE_TO_CPW;break;case"FN_CPW_SUCCESS":e.field_info[t].id_function=FN_CPW_SUCCESS;break;case"FN_CPW_SUCCESS_INVALID":e.field_info[t].id_function=FN_CPW_SUCCESS_INVALID;break;case"FN_NAVIGATE_TO_ACCTMGMT":e.field_info[t].id_function=FN_NAVIGATE_TO_ACCTMGMT;break;case"FN_CPW_SUBMIT":e.field_info[t].id_function=FN_CPW_SUBMIT;break;case"FN_IS_LOGGED_IN":e.field_info[t].id_function=FN_IS_LOGGED_IN;break;case"FN_IS_LOGGED_IN_NEGATION":e.field_info[t].id_function=FN_IS_LOGGED_IN_NEGATION;break;case"FN_LOGIN_SUBMIT":e.field_info[t].id_function=FN_LOGIN_SUBMIT;break;case"FN_POPUP_EXISTS":e.field_info[t].id_function=FN_POPUP_EXISTS;break;case"FN_POPUP_DISMISS":e.field_info[t].id_function=FN_POPUP_DISMISS;break;case"FN_REVEAL_LOGIN":e.field_info[t].id_function=FN_REVEAL_LOGIN;break;case"FN_CHALLENGE_LOGIN":e.field_info[t].id_function=FN_CHALLENGE_LOGIN;break;case"FN_CHALLENGE_PASSWORD":e.field_info[t].id_function=FN_CHALLENGE_PASSWORD;break;case"FN_CHALLENGE_OTHER":e.field_info[t].id_function=FN_CHALLENGE_OTHER;break;case"FN_CHALLENGE_SUBMIT":e.field_info[t].id_function=FN_CHALLENGE_SUBMIT;break;case"FN_CHALLENGE_INVALID":e.field_info[t].id_function=FN_CHALLENGE_INVALID;break;case"FN_CHALLENGE_SUCCESS":e.field_info[t].id_function=FN_CHALLENGE_SUCCESS;break;case"FN_CHALLENGE_SUCCESS_INVALID":e.field_info[t].id_function=FN_CHALLENGE_SUCCESS_INVALID;break;case"FN_NAVIGATE_TO_LOGOUT":e.field_info[t].id_function=FN_NAVIGATE_TO_LOGOUT;break;case"FN_EPHEMERAL_STATE":e.field_info[t].id_function=FN_EPHEMERAL_STATE;break;case"FN_CAPTCHA":e.field_info[t].id_function=FN_CAPTCHA;break;case"FN_MULTI_FACTOR":e.field_info[t].id_function=FN_MULTI_FACTOR;break;case"FN_PASSWORD_HINT":e.field_info[t].id_function=FN_PASSWORD_HINT;break;case"FN_POPUP_EXISTS_INVALID":e.field_info[t].id_function=FN_POPUP_EXISTS_INVALID;break;case"FN_FORCE_FAIL":e.field_info[t].id_function=FN_FORCE_FAIL;break;case"FN_CAPTCHA_SUCCESS":e.field_info[t].id_function=FN_CAPTCHA_SUCCESS;break;case"FN_MULTI_FACTOR_SUCCESS":e.field_info[t].id_function=FN_MULTI_FACTOR_SUCCESS;break;case"FN_PASSWORD_HINT_SUCCESS":e.field_info[t].id_function=FN_PASSWORD_HINT_SUCCESS;break;case"FN_LOGIN_ENTRY_INVALID":e.field_info[t].id_function=FN_LOGIN_ENTRY_INVALID;break;case"FN_LOGIN_ENTRY_USERNAME":e.field_info[t].id_function=FN_LOGIN_ENTRY_USERNAME;break;case"FN_LOGIN_ENTRY_PASSWORD":e.field_info[t].id_function=FN_LOGIN_ENTRY_PASSWORD;break;case"FN_LOGIN_ENTRY_SUBMIT":e.field_info[t].id_function=FN_LOGIN_ENTRY_SUBMIT;break;case"FN_LOGIN_ENTRY_SUCCESS":e.field_info[t].id_function=FN_LOGIN_ENTRY_SUCCESS;break;case"FN_LOGIN_ENTRY_SUCCESS_INVALID":e.field_info[t].id_function=FN_LOGIN_ENTRY_SUCCESS_INVALID;break;case"FN_REVEAL_LOGOUT":e.field_info[t].id_function=FN_REVEAL_LOGOUT;break;case"FN_FAKEUI_LOGGED_IN_1":e.field_info[t].id_function=FN_FAKEUI_LOGGED_IN_1;break;case"FN_FAKEUI_LOGGED_IN_2":e.field_info[t].id_function=FN_FAKEUI_LOGGED_IN_2;break;case"FN_FAKEUI_LOGGED_IN_3":e.field_info[t].id_function=FN_FAKEUI_LOGGED_IN_3;break;case"FN_FAKEUI_LOGGED_IN_INPUT":e.field_info[t].id_function=FN_FAKEUI_LOGGED_IN_INPUT;break;case"FN_FAKEUI_LOGGED_OUT_1":e.field_info[t].id_function=FN_FAKEUI_LOGGED_OUT_1;break;case"FN_FAKEUI_LOGGED_OUT_2":e.field_info[t].id_function=FN_FAKEUI_LOGGED_OUT_2;break;case"FN_FAKEUI_LOGGED_OUT_3":e.field_info[t].id_function=FN_FAKEUI_LOGGED_OUT_3;break;case"FN_FAKEUI_LOGGED_OUT_OUTPUT":e.field_info[t].id_function=FN_FAKEUI_LOGGED_OUT_INPUT}}if(void 0!==e.jsfrags)for(var t=0;t<e.jsfrags.length;t++)if(void 0!==e.jsfrags[t].jstype)switch(e.jsfrags[t].jstype){case"JS_PRE_NAVIGATE_CPW":e.jsfrags[t].jstype=JS_PRE_NAVIGATE_CPW;break;case"JS_PRE_LOGIN":e.jsfrags[t].jstype=JS_PRE_LOGIN;break;case"JS_POST_NAVIGATE_CPW":e.jsfrags[t].jstype=JS_POST_NAVIGATE_CPW;break;case"JS_POST_LOGIN":e.jsfrags[t].jstype=JS_POST_LOGIN;break;case"JS_PRE_CPW":e.jsfrags[t].jstype=JS_PRE_CPW;break;case"JS_POST_CPW":e.jsfrags[t].jstype=JS_POST_CPW;break;case"JS_PRE_ACCTMGMT":e.jsfrags[t].jstype=JS_PRE_ACCTMGMT;break;case"JS_POST_ACCTMGMT":e.jsfrags[t].jstype=JS_POST_ACCTMGMT;break;case"JS_LOGIN_REVEAL":e.jsfrags[t].jstype=JS_LOGIN_REVEAL;break;case"JS_VALIDATE_LOGIN_SUCCESS":e.jsfrags[t].jstype=JS_VALIDATE_LOGIN_SUCCESS;break;case"JS_VALIDATE_CPW_SUCCESS":e.jsfrags[t].jstype=JS_VALIDATE_CPW_SUCCESS;break;case"JS_LOGIN_SUBMIT":e.jsfrags[t].jstype=JS_LOGIN_SUBMIT;break;case"JS_FINISH":e.jsfrags[t].jstype=JS_FINISH;break;case"JS_PRE_CHALLENGE":e.jsfrags[t].jstype=JS_PRE_CHALLENGE;break;case"JS_POST_CHALLENGE":e.jsfrags[t].jstype=JS_POST_CHALLENGE;break;case"JS_CHALLENGE_SUBMIT":e.jsfrags[t].jstype=JS_CHALLENGE_SUBMIT;break;case"JS_VALIDATE_CHALLENGE_SUCCESS":e.jsfrags[t].jstype=JS_VALIDATE_CHALLENGE_SUCCESS;break;case"JS_BEGIN":e.jsfrags[t].jstype=JS_BEGIN;break;case"JS_PRE_LOGOUT":e.jsfrags[t].jstype=JS_PRE_LOGOUT;break;case"JS_POST_LOGOUT":e.jsfrags[t].jstype=JS_POST_LOGOUT;break;case"JS_PRE_LOGIN_ENTRY":e.jsfrags[t].jstype=JS_PRE_LOGIN_ENTRY;break;case"JS_POST_LOGIN_ENTRY":e.jsfrags[t].jstype=JS_POST_LOGIN_ENTRY;break;case"JS_LOGIN_ENTRY_SUBMIT":e.jsfrags[t].jstype=JS_LOGIN_ENTRY_SUBMIT;break;case"JS_PRE_DOCAPTCHA":e.jsfrags[t].jstype=JS_PRE_DOCAPTCHA;break;case"JS_POST_DOCAPTCHA":e.jsfrags[t].jstype=JS_POST_DOCAPTCHA}if(void 0!==e.click_flavor)switch(e.click_flavor){case"CLICK_NO_FOCUS":e.click_flavor=CONST_CLICK_NO_FOCUS;break;case"CLICK_MOUSEDOWN":e.click_flavor=CONST_CLICK_MOUSEDOWN;break;case"CLICK_STRANGE":e.click_flavor=CONST_CLICK_STRANGE;break;case"CLICK_NOMINAL":default:e.click_flavor=CONST_CLICK_NOMINAL}return e}function CPWbot_bg_lib(){function e(){return m_last_overlay_msg}function t(e){m_last_overlay_msg=e}function i(){t("")}function n(e){return e?e.login_url:null}function _(e){return e?e.cpw_url:null}function o(e){return e?e.acctmgmt_url:null}function a(e){return e?e.logout_url:null}function r(e){return e?e.fakeui_loggedout_url:null}function l(e){return e?e.fakeui_loggedin_url:null}function s(e){if(!e)return null;var t=e.click_flavor;if("string"==typeof t){var i=parseInt(t);if(!isNaN(i))return i}return e.click_flavor}function c(e){return P(e,FN_PASSWORD)}function u(e){return P(e,FN_LOGIN)}function d(e){return P(e,FN_CURRENT_PASS)}function f(e){return P(e,FN_NEW_PASS)}function g(e){return P(e,FN_NEW_PASS_CONFIRM)}function p(e){return P(e,FN_NAVIGATE_TO_CPW)}function b(e){return P(e,FN_NAVIGATE_TO_ACCTMGMT)}function m(e){return P(e,FN_NAVIGATE_TO_LOGOUT)}function v(e){return P(e,FN_CPW_SUBMIT)}function C(e){return P(e,FN_LOGIN_SUBMIT)}function h(e){return P(e,FN_REVEAL_LOGIN)}function N(e){return P(e,FN_LOGIN_ENTRY_USERNAME)}function S(e){return P(e,FN_LOGIN_ENTRY_PASSWORD)}function E(e){return P(e,FN_LOGIN_ENTRY_SUBMIT)}function P(e,t){if(!e||!e.field_info)return null;var i,n=null,_=null;for(i=0;i<e.field_info.length;i++)if(n=e.field_info[i],n.id_function==t){_={id_type:n.id_type,id_value:n.id_value};break}return _}function w(e){return ne(e,JS_PRE_NAVIGATE_CPW)}function I(e){return ne(e,JS_POST_NAVIGATE_CPW)}function A(e){return ne(e,JS_PRE_ACCTMGMT)}function T(e){return ne(e,JS_POST_ACCTMGMT)}function O(e){return ne(e,JS_PRE_CPW)}function k(e){return ne(e,JS_POST_CPW)}function W(e){return ne(e,JS_PRE_LOGIN)}function F(e){return ne(e,JS_POST_LOGIN)}function y(e){return ne(e,JS_LOGIN_REVEAL)}function G(e){return ne(e,JS_LOGIN_SUBMIT)}function D(e){return ne(e,JS_LOGIN_ENTRY_SUBMIT)}function R(e){return ne(e,JS_VALIDATE_LOGIN_SUCCESS)}function U(e){return ne(e,JS_VALIDATE_CPW_SUCCESS)}function M(e){return ne(e,JS_FINISH)}function j(e){return ne(e,JS_VALIDATE_CHALLENGE_SUCCESS)}function V(e){return ne(e,JS_BEGIN)}function J(e){return ne(e,JS_PRE_LOGOUT)}function H(e){return ne(e,JS_POST_LOGOUT)}function B(e){return ne(e,JS_PRE_LOGIN_ENTRY)}function Y(e){return ne(e,JS_POST_LOGIN_ENTRY)}function x(e){return ne(e,JS_VALIDATE_LOGIN_ENTRY_SUCCESS)}function K(e){return ne(e,JS_PRE_DOCAPTCHA)}function q(e){return ne(e,JS_POST_DOCAPTCHA)}function z(e){var t=null;return e&&void 0!==e.cpw_change_success_url&&(t=e.cpw_change_success_url),t}function X(e){var t=null;return e&&void 0!==e.cpw_change_failure_url&&(t=e.cpw_change_failure_url),t}function Q(e){var t=null;return e&&void 0!==e.login_failure_url&&(t=e.login_failure_url),t}function Z(e){var t=null;return e&&void 0!==e.login_success_url&&(t=e.login_success_url),t}function $(e){var t=null;return e&&void 0!==e.login_entry_failure_url&&(t=e.login_entry_failure_url),t}function ee(e){var t=null;return e&&void 0!==e.login_entry_success_url&&(t=e.login_entry_success_url),t}function te(e){var t=null;return e&&void 0!==e.challenge_invalidate_url&&(t=e.challenge_invalidate_url),t}function ie(e){var t=null;return e&&void 0!==e.challenge_validate_url&&(t=e.challenge_validate_url),t}function ne(e,t){if(!e||!e.jsfrags)return null;var i,n,_;for(i=0;i<e.jsfrags.length;i++)if(n=e.jsfrags[i],n.jstype==t){_=n.jsfrag;break}return _}function _e(e,t,i){if(!t||!i)return null;var n=i(t);if(n){var _=(new Date).getTime();null===_&&(_=0);var o,a,r="function"==typeof lp_sha256?lp_sha256:SHA256,l=r(e.toString()+n+_.toString());a="function"==typeof fasthash?fasthash:"function"==typeof crc32?crc32:"function(j) { if (j) { return j.length; } return 0; }";var o=a(n);return verbose_log("injecting javascript fragment into CS: "+n),lt(Xi,"Injected Javascript into Document"),sendCS(e,{cmd:"run_cpwbot_js",req_id:l,js:n,hash:o},"all"),!0}return!1}function oe(e){return"undefined"!=typeof g_sites?g_sites[e]:"undefined"!=typeof lpaccts?lpaccts[e]:null}function ae(e,t,i,n,_,o,a){if(!i)return!1;null===n&&(n=0),null===o&&(o=0),void 0!==_&&null!==_||(_=DEFAULT_FILL_DELAY),lt(Xi,"Filling Field");var r=(new Date).getTime();null===r&&(r=0);var l="function"==typeof lp_sha256?lp_sha256:SHA256,s=l(e.toString()+i.id_value+r.toString());return sendCS(e,{cmd:"cpwbot_fill_field",req_id:s,id_type:i.id_type,id_value:i.id_value,field_value:t,type:"text",formname:"",should_click:n,should_fill_via_keys:o,delay:_},"all"),!0}function re(e,t,i,n,_,o,a){if(!i)return!1;null===n&&(n=0),null===o&&(o=0),void 0!==_&&null!==_||(_=DEFAULT_FILL_DELAY),lt(Xi,"Filling Password Field");var r=(new Date).getTime();null===r&&(r=0);var l="function"==typeof lp_sha256?lp_sha256:SHA256,s=l(e.toString()+i.id_value+r.toString());return sendCS(e,{cmd:"cpwbot_fill_field",req_id:s,id_type:i.id_type,id_value:i.id_value,field_value:t,type:"password",formname:"",should_click:n,should_fill_via_keys:o,delay:_,flavor:a},"all"),!0}function le(e,t,i,n){if(!t)return!1;void 0!==i&&null!==i||(i=DEFAULT_CLICK_DELAY),void 0===n&&(n=CONST_CLICK_NOMINAL),An=(new Date).getTime()+CLICK_RETRY_TIME+i,Tn=!1,lt(Xi,"Clicking");var _=(new Date).getTime();null===_&&(_=0);var o="function"==typeof lp_sha256?lp_sha256:SHA256,a=o(e.toString()+t.id_value+_.toString());verbose_log("click_field id="+a+" saved to m_pwchange_last_click_field_id"),qt=a,On=0;var r={cmd:"cpwbot_click_field",msgid:a,pwchangestate:Mt,id_type:t.id_type,id_value:t.id_value,delay:i,flavor:n};return sendCS(e,r,"all"),m_lastclick_metadata=r,!0}function se(e,t,i){if(!t||!i)return!1;var n="",_="",o=oe(i.aid);if(!o)return Ot("given invalid aid - data consistency error?"),!1;CPWbot_bg.do_milestone(e,yi,t),L("pre-login-form-js"),_e(e,t,W);var a=u(t),r=c(t),l=_t(t),d=ot(t),f=rnd2=0;Pi&&(f=Gt(),rnd2=Gt());var g=0,p=s(t);return a&&(g++,n=getusernamefromacct(o),ae(e,n,a,l,0*g+f,!1,p)),r&&(g++,_=getpasswordfromacct(o),re(e,_,r,l,0*g+f+rnd2,d,p)),L("post-login-form-js"),_e(e,t,F),!0}function ce(e,t,i){if(!t)return!1;CPWbot_bg.do_milestone(e,Gi,t);var n=!1;ai=!1;var _=C(t);if(_){var o=DEFAULT_CLICK_DELAY;void 0!==t.login_delay&&(o=t.login_delay),ai=!0;le(e,_,o,s(t)),n=!0}return _e(e,t,G)&&(n=!0),!n||null}function ue(e,t,i){if(!t||!i)return!1;var n="",_="",o=oe(i.aid);if(!o)return Ot("given invalid aid - data consistency error?"),!1;CPWbot_bg.do_milestone(e,Mi,t),_e(e,t,B);var a=N(t),r=S(t),l=_t(t),c=ot(t),u=rnd2=0;Pi&&(u=Gt(),rnd2=Gt());var d=0,f=s(t);return a&&(d++,n=getusernamefromacct(o),ae(e,n,a,l,0*d+u,!1,f)),r&&(d++,_=getpasswordfromacct(o),re(e,_,r,l,0*d+u+rnd2,c,f)),_e(e,t,Y),!0}function de(e,t,i){if(!t)return!1;CPWbot_bg.do_milestone(e,Ui,t);var n=!1;di=!1;var _=E(t);if(_){var o=DEFAULT_CLICK_DELAY;void 0!==t.login_delay&&(o=t.login_delay),di=!0;le(e,_,o,s(t)),CPWbot_bg.mark_timestamp("wait_for_click_ack_M"),n=!0}return _e(e,t,D)&&(n=!0),!n||null}function fe(e,t,i){if(!t||!i)return!1;lt(Qi,"Updating with New Password");var n=!0,_=i.aid;console_log("cpwbot initiate: save_replace for aid="+_);var o=oe(_);if(!o)return Ot("given invalid aid - data consistency error?"),!1;var a,r,a=lpdec_acct(i.newpw,o,"undefined"==typeof g_shares?lpshares:g_shares),r=lpdec_acct(i.curpw,o,"undefined"==typeof g_shares?lpshares:g_shares);if(o&&a&&r)if(o.pwprotect&&(n=!1),console_log("cpwbot initiate: calling changepw logic for aid="+_),g_isfirefox)(n||LP.securityPrompt())&&lpchangepw(null,a,_,null,null,null,!0);else{var l={singleaid:_.toString(),newpw:a,autochange:1};n?changepw_wrapper(l):security_prompt(function(){changepw_wrapper(l)})}else verbose_log("no passwords to save? acct.aid = "+(o?o.aid:"null")+" cur="+(g_show_pw_in_logs||g_isadmin?r:"REDACTED")+" newpw="+(g_show_pw_in_logs||g_isadmin?a:"REDACTED"));return!0}function ge(e){if(verbose_log("entered cpwbot_cs_finish to clean up "+e),null!==jt){if(jt!=e)return void(null!==jt&&verbose_log("stale call: started up a new password change on different tab - ABORT - tabid=="+e+" g_pwchangetabid="+jt));var t={aid:Ht,recipe:Jt,desc:"cpwbot_finish"};g_v2engine?CPWbot_bg.wait_for_doc_complete(e,null,function(e){verbose_log("cpwbot_finish callback!  on tabid="+e),sendCS(e,{cmd:"cpwbot_finish"},"all")},t):sendCS(e,{cmd:"cpwbot_finish"})}}function pe(e){var t,i=[],n=[FN_CPW_OTHER,FN_CURRENT_PASS,FN_NEW_PASS,FN_NEW_PASS_CONFIRM];for(t=0;t<n.length;t++){var _=De(e,n[t]);_&&_.length>0&&(i=i.concat(_))}return i}function be(e){var t,i,n=[],_=[FN_CPW_INVALID];for(t=0;t<_.length;t++){var o=De(e,_[t]);if(o&&o.length>0)for(i=0;i<o.length;i++){var a=o[i];a&&n.push(a)}}return n}function me(e){var t,i=[],n=[FN_PASSWORD,FN_LOGIN_OTHER];for(t=0;t<n.length;t++){var _=De(e,n[t]);_&&_.length>0&&(i=i.concat(_))}return i}function ve(e){var t,i=[],n=[FN_LOGIN_INVALID];for(t=0;t<n.length;t++){var _=De(e,n[t]);_&&_.length>0&&(i=i.concat(_))}return i}function Ce(e){var t,i=[],n=[FN_LOGIN_ENTRY_USERNAME,FN_LOGIN_ENTRY_PASSWORD,FN_LOGIN_ENTRY_SUBMIT];for(t=0;t<n.length;t++){var _=De(e,n[t]);_&&_.length>0&&(i=i.concat(_))}return i}function he(e){var t,i=[],n=[FN_LOGIN_ENTRY_USERNAME];for(t=0;t<n.length;t++){var _=De(e,n[t]);_&&_.length>0&&(i=i.concat(_))}return i}function Ne(e){var t,i=[],n=[FN_LOGIN_ENTRY_INVALID];for(t=0;t<n.length;t++){var _=De(e,n[t]);_&&_.length>0&&(i=i.concat(_))}return i}function Se(e){var t,i=[],n=[FN_LOGIN_SUCCESS];for(t=0;t<n.length;t++){var _=De(e,n[t]);_&&_.length>0&&(i=i.concat(_))}return i}function Le(e){var t,i=[],n=[FN_LOGIN_SUCCESS_INVALID];for(t=0;t<n.length;t++){var _=De(e,n[t]);_&&_.length>0&&(i=i.concat(_))}return i}function Ee(e){var t,i=[],n=[FN_LOGIN_ENTRY_SUCCESS];for(t=0;t<n.length;t++){var _=De(e,n[t]);_&&_.length>0&&(i=i.concat(_))}return i}function Pe(e){var t,i=[],n=[FN_LOGIN_ENTRY_SUCCESS_INVALID];for(t=0;t<n.length;t++){var _=De(e,n[t]);_&&_.length>0&&(i=i.concat(_))}return i}function we(e){var t,i=[],n=[FN_CPW_SUCCESS];for(t=0;t<n.length;t++){var _=De(e,n[t]);_&&_.length>0&&(i=i.concat(_))}return i}function Ie(e){var t,i=[],n=[FN_CPW_SUCCESS_INVALID];for(t=0;t<n.length;t++){var _=De(e,n[t]);_&&_.length>0&&(i=i.concat(_))}return i}function Ae(e){var t,i=[],n=[FN_IS_LOGGED_IN];for(t=0;t<n.length;t++){var _=De(e,n[t]);_&&_.length>0&&(i=i.concat(_))}return i}function Te(e){var t,i=[],n=[FN_IS_LOGGED_IN_NEGATION];for(t=0;t<n.length;t++){var _=De(e,n[t]);_&&_.length>0&&(i=i.concat(_))}return i}function Oe(e){var t,i=[],n=[FN_CHALLENGE_PASSWORD,FN_CHALLENGE_OTHER];for(t=0;t<n.length;t++){var _=De(e,n[t]);_&&_.length>0&&(i=i.concat(_))}return i}function ke(e){var t,i=[],n=[FN_CHALLENGE_INVALID];for(t=0;t<n.length;t++){var _=De(e,n[t]);_&&_.length>0&&(i=i.concat(_))}return i}function We(e){return P(recipe_obj,FN_CHALLENGE_SUCCESS)}function Fe(e){return P(recipe_obj,FN_CHALLENGE_SUCCESS_INVALID)}function ye(e){var t,i=[],n=[FN_CAPTCHA,FN_PASSWORD_HINT,FN_MULTI_FACTOR];for(t=0;t<n.length;t++){var _=De(e,n[t]);_&&_.length>0&&(i=i.concat(_))}return i}function Ge(e){var t,i=[],n=[FN_CAPTCHA_SUCCESS,FN_PASSWORD_HINT_SUCCESS,FN_MULTI_FACTOR_SUCCESS];for(t=0;t<n.length;t++){var _=De(e,n[t]);_&&_.length>0&&(i=i.concat(_))}return i}function De(e,t){var i=[];if(!e||!e.field_info)return i;var n,_,o;for(n=0;n<e.field_info.length;n++)_=e.field_info[n],_.id_function==t&&(o={id_type:_.id_type,id_value:_.id_value},i.push(o));return i}function Re(e){var t=DEFAULT_VALIDATE_TIMEOUT;if(!e)return t;if(void 0!==e.validate_timeout){var i=parseInt(e.validate_timeout);i&&!isNaN(i)&&(t=i)}return t}function Ue(e,t,i){if(null===i&&(i=1),null===e||!t)return!1;var n=t.desc,_=t.recipe,o=t.fn_url_failed,a=t.fn_url_success,r=t.fn_required,l=t.fn_rejected;t.fn_captcha;an=!0,on=(new Date).getTime(),gi=!1,pi=!1;console_log("cpwbot check_tab_for_state for "+n);var s=r?r(_):[],c=l?l(_):[],u=CPWbot_bg.JSON.stringify(s),d=CPWbot_bg.JSON.stringify(c),f=ye(_),g=CPWbot_bg.JSON.stringify(f);if(zt=mt(e),0==s.length&&0==c.length&&!a&&!o)return L("WARN: "+n+" has no field or url criteria defined to validate against"),!0;var p=Re(_),b=a?a(_):null,m=o?o(_):null,v=(new Date).getTime();null===v&&(v=0);var C="function"==typeof lp_sha256?lp_sha256:SHA256,h=C(e.toString()+n+v.toString());Yt=h,Pn=u,wn=d,verbose_log("interrogate id="+Yt+" desc="+n),Xt=[];var N={cmd:"cpwbot_validate_state",desc:n,required_fields:u,rejected_fields:d,id:Yt,validate_timeout:p,timestamp:v,proceed_on_interactive:Ze(_)?1:0,interactive_fields:g};return b&&(N.required_url=b),m&&(N.rejected_url=m),Bt=N,xt=n,sendCS(e,N,"all"),verbose_log("setup setimeout for "+p/1e3+" seconds finish_cpwbot_validate_state"),setTimeout(function(){CPWbot_bg&&CPWbot_bg.finish_cpwbot_validate_state(e,h,u,d,n)},p),null}function Me(){return null}function je(i,n,_,o){if(o||!CPWbot_bg.get_docaptchastate()){n?t(n):n=e(),_||(_=Jt);var a={msg:n,symbolic:yt(_)},r=CPWbot_bg.JSON.stringify(a);sendCS(i,{cmd:"do_cpwbot_overlay",msg:r},g_CS_tops[i])}}function Ve(e){return sendCS(e,{cmd:"hide_cpwbot_overlay"},"all"),!0}function Je(e){var t=null;return e?(void 0!==e.generate_pref_overrides&&(t=e.generate_pref_overrides),t):t}function He(e){var t=0;return e?(void 0!==e.postacctmgmt_sleep&&(t=e.postacctmgmt_sleep),t):null}function Be(e){var t=0;return e?(void 0!==e.postrevealcpw_sleep&&(t=e.postrevealcpw_sleep),t):null}function Ye(e){var t=0;return e?(void 0!==e.posttrigger_sleep&&(t=e.posttrigger_sleep),t):null}function xe(e){var t=0;return e?(void 0!==e.postreveallogin_sleep&&(t=e.postreveallogin_sleep),t):null}function Ke(e){var t=0;return e?(void 0!==e.postlogout_sleep&&(t=e.postlogout_sleep),t):null}function qe(e){var t=!1;return e?(void 0!==e.reveal_login_js_delay&&(t=!!e.reveal_login_js_delay),t):null}function ze(e){var t=!1;return e?(void 0!==e.navigate_acctmgmt_js_delay&&(t=!!e.navigate_acctmgmt_js_delay,"0"===e.navigate_acctmgmt_js_delay&&(t=!1)),t):null}function Xe(e){var t=!1;return e?(void 0!==e.reveal_cpw_js_delay&&(t=!!e.reveal_cpw_js_delay,"0"===e.reveal_cpw_js_delay&&(t=!1)),t):null}function Qe(e){var t=!1;return e?(void 0!==e.logout_js_delay&&(t=!!e.logout_js_delay,"0"===e.logout_js_delay&&(t=!1)),t):null}function Ze(e){var t=!1;return e?(void 0!==e.proceed_on_interactive&&(t=!!e.proceed_on_interactive,"0"===e.proceed_on_interactive&&(t=!1)),t):null}function $e(e){var t=0;return e?(void 0!==e.start_delay&&(t=e.start_delay),t):null}function et(e){var t=0;return e?(void 0!==e.post_login_submit_delay&&(t=e.post_login_submit_delay),t):null}function tt(e){var t=0;return e?(void 0!==e.post_js_begin_delay&&(t=e.post_js_begin_delay),t):null}function it(e){var t=0;return e?(void 0!==e.js_finish_delay&&(t=e.js_finish_delay),t):null}function nt(e){var t=0;return e?(void 0!==e.session_timeout&&"number"==typeof e.session_timeout&&(t=e.session_timeout),t):null}function _t(e){var t=0;return e?(void 0!==e.click_on_fields_on_fill&&(t=e.click_on_fields_on_fill?1:0),t):null}function ot(e){var t=0;return e?(void 0!==e.fill_password_fields_via_keys&&(t=e.fill_password_fields_via_keys?1:0),t):null}function at(e){if(!e)return null;var t=DEFAULT_FILL_DELAY;return"number"==typeof e.fill_field_delay&&(t=e.fill_field_delay),verbose_log("fill field delay : "+t),t}function rt(e){var t=!1;return e?(void 0!==e.document_complete_timeout&&(t=e.document_complete_timeout),t):null}function lt(e,t){var i=["DEBUG","INFO","WARN","ERR"];if((e<Xi||e>$i)&&(e=Xi),g_isfirefox&&lpisadmin||g_isdebug||g_isadmin){var n="["+i[e]+"] "+t+"\n";return ii+=n,verbose_log(n),write_history({cmd:"CPW",msg:n}),!0}return!1}function st(e,t){var i=!1;if(!t||!e)return debug&&L("validate_xpath: none"),i;try{var n=g_isfirefox?new e.defaultView.XPathEvaluator:new XPathEvaluator;if(!n&&debug)return L("NO XPATH EVALUATOR AVAILABLE ????"),!0;n.evaluate(t,e.documentElement,null,g_isfirefox?e.defaultView.XPathResult.FIRST_ORDERED_NODE_TYPE:XPathResult.FIRST_ORDERED_NODE_TYPE,null);i=!0}catch(e){console_error("error validating '"+t+"', exception: "+e),i=!1}return i}function ct(e){var t=g_isfirefox?LP.getBrowser().selectedTab.linkedBrowser.contentDocument:document;if(!t||!e)return L("Bad Recipe: none"),!1;var i,_;if(!n(e))return L("Bad Recipe: no login url"),!1;if(!yt(e))return L("Bad Recipe: no symbolic"),!1;if(!e.field_info||e.field_info.length<=0)return L("Bad Recipe: no fields"),!1;if(!ut(e))return!1;var o=!1,r=!1,l=!1,s=!1,c=!1,u=!1,d=!1,f=!1,g=!1;for(i=0;i<e.field_info.length;i++)switch(_=e.field_info[i],_.id_function){case FN_LOGIN:case FN_LOGIN_SUBMIT:case FN_PASSWORD:o=!0;break;case FN_CURRENT_PASS:case FN_NEW_PASS:case FN_NEW_PASS_CONFIRM:case FN_CPW_SUBMIT:c=!0;break;case FN_CPW_SUCCESS:case FN_CPW_SUCCESS_INVALID:u=!0;break;case FN_LOGIN_SUCCESS:case FN_LOGIN_SUCCESS_INVALID:l=!0;break;case FN_IS_LOGGED_IN:case FN_IS_LOGGED_IN_NEGATION:r=!0;break;case FN_NAVIGATE_TO_LOGOUT:f=!0}if((z(e)||X(e)||U(e))&&(d=!0),(Z(e)||Q(e)||R(e))&&(s=!0),a(e)&&(g=!0),!(o&&r&&(l||s)&&c&&(f||g)&&(u||d)))return L("Bad Recipe for "+yt(e)+": has_login_fields?"+o+" has_logged_in_fields?"+r+" has_login_success_fields?"+l+" has_login_success_alt?"+s+" has_logout_field?"+f+" has_logout_alt?"+g+" has_cpw_fields?"+c+" has_cpw_success_fields?"+u+" has_cpw_success_alt?"+d),!1;for(i=0;i<e.field_info.length;i++)if(_=e.field_info[i],_.id_type==TYPE_XPATH){if(!st(t,_.id_value))return L("Bad Recipe: bad xpath"),!1;if(_.id_value&&_.id_value.indexOf("@clas,")>0)return L("Bad Recipe: @clas mispell"),!1}else if((_.id_type==TYPE_ID||_.id_type==TYPE_NAME)&&_.id_value&&(_.id_value.indexOf("//")>=0||_.id_value.indexOf("text()")>=0||_.id_value.indexOf("contents(")>=0))return L("Bad Recipe: xpath in non-xpath field def"),!1;return!0}function ut(e){var t,i,n,_=!0,o={id_function:1,id_value:1,id_type:1};if(!e.field_info||e.field_info.length<=0)return!1;for(i=0;i<e.field_info.length;i++){t=e.field_info[i],t&&"number"!=typeof t.id_function&&(verbose_log(sprintf("field %s has invalid function '%s'",t.id_value,t.id_function)),_=!1);for(n in t)t.hasOwnProperty(n)&&(o[n]||(verbose_log(sprintf("found invalid field property '%s'",n)),_=!1))}if(o={jsfrag:1,jstype:1},e.jsfrags&&e.jsfrags.length>0)for(i=0;i<e.jsfrags.length;i++){t=e.jsfrags[i],t&&"number"!=typeof t.jstype&&(verbose_log(sprintf("js with invalid type '%s'",t.jstype)),_=!1);for(n in t)t.hasOwnProperty(n)&&(o[n]||(verbose_log(sprintf("found invalid javascript property '%s'",n)),_=!1))}if(o={length:1,maxlength:1,minlength:1,special:1,digits:1,upper:1,lower:1,mindigits:1},e.generate_pref_overrides)for(n in e.generate_pref_overrides)e.generate_pref_overrides.hasOwnProperty(n)&&(o[n]||(verbose_log(sprintf("found invalid generate preference '%s'",n)),_=!1));return _}function dt(){return oi||li||ri||ai||ui||di||si||ci}function ft(){oi=!1,li=!1,ri=!1,ai=!1,ui=!1,di=!1,si=!1,ci=!1}function gt(e,t,i){return Ge(t).length>0}function pt(e,t){var i=t.docnum,n=t.url;return null!==fi&&(null!==fi[i]&&void 0!==fi[i]||CPWbot_bg.clear_frame_score(e,i,n),fi[i]=fi[i]+2,!0)}function bt(e,t){var i=t.docnum,n=t.url;return null!==fi&&(null!==fi[i]&&void 0!==fi[i]||CPWbot_bg.clear_frame_score(e,i,n),fi[i]=fi[i]+-2,!0)}function mt(e){if(null===fi||null===e)return 0;var t,i,n,_=0;for(i in CS_table)CS_table.hasOwnProperty(i)&&(n=CS_table[i],n.tabid===e&&(t=n.docnum,(CPWbot_bg.skip_frame_by_score(t)||skip_CS_by_score(e,t))&&_++));return _}function vt(e,t){null!==e&&null!==g_CS_tops[e]&&sendCS(e,{cmd:"do_result_div",msg:t},g_CS_tops[e])}function Ct(e,t){var i=nt(t);i||(i=DEFAULT_SESSION_TIMEOUT),null!==Gn&&Gn>0&&!isNaN(Gn)&&(i*=Gn);var n=CPWbot_bg.get_session();CPWbot_bg.session_timeout_st_id=setTimeout(function(){if(n!=CPWbot_bg.get_session())return void verbose_log("stale timeout");CPWbot_bg.mark_timestamp("session_timeout");var t=CPWbot_bg.get_timestamp("session_timeout")-CPWbot_bg.get_timestamp("initial_cycle");if(verbose_log(sprintf("session timeout at %6.2f seconds after T=0",t/1e3)),verbose_log("SESSION TIMEOUT WAKEUP"),!ni&&!_i&&jt==e)return Tt("timeout: a change is still running ? tabid="+e+"last state ="+Mt),void CPWbot_bg.panic("session timeout");ge(e),CPWbot_bg.cpwbot_cs_finish_complete(e)},i)}function ht(e,t,i){verbose_log("B1: validate_login_form "),Mt="B1";var n=null,_={aid:i.aid,recipe:t};return null===(n=CPWbot_bg.validate_login_form(e,t,_))?(verbose_log("B1: validate_login_form / CS callout "),Nn=!0,L("VALIDATE_IN_DOCWAIT=true"),null):n?(do_A4(e,t,i),!0):(CPWbot_bg.do_milestone(e,Vi,t,""),ge(e),!1)}function Nt(e,t,i){setTimeout(function(){lploggedin&&CPWbot_bg&&CPWbot_bg.engine(e,t,i)},250)}function St(){var e,t;for(e=0;e<ln.length;e++)if(t=ln[e],"validate_response"==t.type)return!0;return!1}function Lt(e,t){var i=m_lastclick_metadata;On>kn&&verbose_log("too many click retries"),i&&(lt(Qi,"Retry Click"),verbose_log("tabid="+e+" id_type="+i.id_type+" id_value="+i.id_value),sendCS(e,i,t),On++)}function Et(e){return(new Date).getTime()>An&&!Tn&&(Tn=!0,Lt(e,"all"),!0)}function Pt(e){return Dn&&Dn.initial_cycle-Dn.dopwchange>1e4&&0!=Dn.initial_cycle&&0!=Dn.dopwchange&&(Gn=2,wt(e,Gn)),!0}function wt(e,t){return L(sprintf("[%s] time factor adjustment=%6.2f",yt(e),t)),!0}function It(){}function At(e,t){return CPWbot_bg.do_milestone(e,xi,t),ge(e),CPWbot_bg.cpwbot_cs_finish_complete(e),!0}function Tt(e){if(CPWbot_bg){lt($i,e);var t={severity:"fatal",msg:e};CPWbot_bg.phone_home(null,null,t)}}function Ot(e){lt(Zi,e);var t={severity:"warning",msg:e};return CPWbot_bg.phone_home(null,null,t)}function kt(e,t,i){if(!t||!i||null===e)return 0;if(!g_cpw_do_fakeui)return 0;Mt="FK0",verbose_log("entered do_logged_out_fake_ui");return 0}function Wt(e,t,i){if(!t||!i||null===e)return 0;if(!g_cpw_do_fakeui)return 0;Mt="FKLL0",verbose_log("entered do_logged_in_fake_ui");return 0}function Ft(e,t){gt(e,t)?CPWbot_bg.do_milestone(e,Fi,t):(CPWbot_bg.do_milestone(e,Ki,t),ge(e))}function yt(e){return e?e.symbolic:""}function Gt(e){return e||(e=100),"undefined"==typeof Math?0:Math.floor(Math.random(e)+10)}function Dt(e,t){return e||(e=100),!1}var Rt=this,Ut=0,Mt=null,jt=null,Vt=null,Jt=null,Ht=0,Bt=null,Yt=null,xt=null,Kt=null,qt=null;i();var zt=null,Xt=[],Qt=!1,Zt=!1,$t=!1,ei=!1,ti=!1,ii="",ni=!1,_i=!1,oi=!1,ai=!1,ri=!1,li=!1,si=!1,ci=!1,ui=!1,di=!1,fi={},gi=!1,pi=!1,bi=!1,mi=!1,vi=!0,Ci=!1,hi=!1,Ni=!1,Si=!1,Li=!1,Ei=!1,Pi=!1,wi=Ii,Ii=0,Ai=3,Ti=4,Oi=5,ki=6,Wi=7,Fi=9,yi=68,Gi=69,Di=70,Ri=71,Ui=74,Mi=75,ji=129,Vi=130,Ji=131,Hi=132,Bi=134,Yi=137,xi=138,Ki=139,qi=141,zi=[];zi[Ii]="",zi[1]=gs("LastPass is loading..."),zi[2]=gs("LastPass is loading website..."),zi[Ai]=gs("LastPass is logging in..."),zi[Ti]=gs("LastPass is changing your password now..."),zi[Oi]=gs("LastPass is changing your password now..."),zi[ki]=gs("LastPass is changing your password now..."),zi[Wi]=gs("LastPass is changing your password now..."),zi[8]=gs("LastPass is logging in..."),zi[Fi]=gs("The website needs you to enter information. Please switch to the tab and enter it."),zi[63]=gs("Congratulations! Your password for %s was updated, and is now saved in your LastPass vault. Your change will sync on every device."),zi[128]=gs("We're sorry. We were not able to change your password automatically for %s. Your password was not changed."),zi[248]=zi[128]+" "+gs("The random password that was generated has been saved to your vault."),zi[136]=zi[128],zi[133]=gs("Timed out waiting for the page to load.  Retry?"),zi[Vi]=zi[128],zi[ji]=zi[128],zi[Bi]=zi[128],zi[135]=zi[128],zi[Ji]=zi[128],zi[Hi]=zi[128],zi[Yi]=zi[128],zi[xi]=gs("Halt Requested"),zi[Ki]=gs("Unable to proceed, the website does not allow automated password change."),zi[140]=gs("Timed out"),zi[qi]=zi[128],"function"==typeof alertfrombg&&(this.alert=alertfrombg),g_isfirefox&&(this.alert=alert),this.JSON=JSON,JSON||(this.JSON=LPJSON),LPJSON,this.get_pwchangestate=function(){return Mt},this.get_pwchangetabid=function(){return jt},this.get_login_url=function(e){return n(e)},this.get_cpw_url=function(e){return _(e)},this.get_acctmgmt_url=function(e){return o(e)},this.conditional_js_exec=function(e,t,i){return _e(e,t,i)},this.show_cpwbot_overlay=function(e,t,i){return je(e,t,i)},this.in_validate=function(){return Bt&&Yt&&null!=xt&&""!=xt&&void 0!==xt},this.in_validate_outer=function(){return Rt.in_validate()||an||Nn},this.get_last_overlay_message=function(){return e()},this.get_fakeui_loggedout_url=function(e){return r(e)},this.get_fakeui_loggedin_url=function(e){return l(e)},this.reveal_cpw=function(e,t){if(!t)return!1;var i=t.recipe,n=t.payload,o=n.aid;if(!i||!n)return!1;L("reveal_cpw called after wait-for-document-complete tabid="+e),CPWbot_bg.mark_timestamp("reveal_cpw"),lt(Qi,"Reveal Change-Password Form"),Mt="D",Zt=!1,_e(e,i,w);var a=_(i);if(a){L("call cpw:loadurl with "+a);var r=null;return g_CS_tops&&(r=g_CS_tops[e],g_ischrome&&0!=r&&L("loadurl is not sending to docnum==0 ! "+r)),sendCS(e,{cmd:"loadurl",url:a},r),sn=!0,verbose_log("m_in_loadurl set"),Jt=i,Vt=n,Zt=!0,null}li=!1;var l=p(i);if(l){verbose_log("click on FN_NAVIGATE_TO_CPW field!");var c=DEFAULT_CLICK_DELAY;void 0!==i.cpw_delay&&(c=i.cpw_delay),li=!0,L("now waiting for click_ack_D");le(e,l,c,s(i)),CPWbot_bg.mark_timestamp("wait_for_click_ack_D")}return Xe(i)&&(Zt=!0,Be(i))?null:(_e(e,i,I),t.didcallout?(L("end of reveal_cpw thread with callout to CS - hack Dpickup to resume for aid="+o),Mt="Dpickup",null):(L("no callout to CS, so reveal_cpw does not end thread, returning to initiate"),!0))},this.navigate_to_acctmgmt=function(e,t){if(!t)return!1;var i=t.recipe,n=t.payload,_=n.aid;if(L("navigate_to_acctmgmt called after wait-for-document-complete tabid="+e),CPWbot_bg.mark_timestamp("acctmgmt_nav"),Mt="C",!i)return!1;lt(Qi,"Navigate to Account Management Page"),$t=!1,_e(e,i,A);var a=o(i);if(a){L("call acctmgmt:loadurl with "+a);var r=null;return g_CS_tops&&(r=g_CS_tops[e]),sendCS(e,{cmd:"loadurl",url:a},r),sn=!0,verbose_log("m_in_loadurl set"),Jt=i,Vt=n,$t=!0,null}ri=!1;var l=b(i);if(l){verbose_log("click on FN_NAVIGATE_TO_ACCTMGMT field!");var c=DEFAULT_CLICK_DELAY;void 0!==i.acctmgmt_delay&&(c=i.acctmgmt_delay),ri=!0,L("now waiting for click_ack C");le(e,l,c,s(i)),CPWbot_bg.mark_timestamp("wait_for_click_ack_C")}return ze(i)&&($t=!0,He(i))?null:(_e(e,i,T),t.didcallout?(L("end of navigate_to_acctmgmt thread with callout to CS - hack Cpickup to resume for aid="+_),Mt="Cpickup",null):(g_v2engine||L("no callout to CS, so nav_to_acctmgmt does not end thread, returning to initiate"),!0))},this.trigger_cpw=function(e,t){if(Ei)return!1;if(Ei=!0,verbose_log("trigger_cpw entered"),CPWbot_bg.mark_timestamp("trigger_cpw"),!t)return!1;var i=t.recipe,n=t.payload;if(!i||!n)return!1;var _=_t(i),o=ot(i);L("trigger_cpw called after wait-for-document-complete tabid="+e),Mt="E";var a=n.aid,r=oe(a),l="";if(!r)return Ot("given invalid aid - data consistency error?"),!1;l=r.url,_e(e,i,O);var c=d(i),u=f(i),p=g(i),b=v(i),m=s(i),C=15,h=1,N=1,S=1,E=0,P=1,w=0,I=1,A=null;g_isfirefox?(LP.lpprefsHasUserValue("genpw_passlen")&&(C=LP.lpprefsGetIntPref("genpw_passlen")),LP.lpprefsHasUserValue("genpw_upper")&&(h=LP.lpprefsGetBoolPref("genpw_upper")?1:0),LP.lpprefsHasUserValue("genpw_lower")&&(N=LP.lpprefsGetBoolPref("genpw_lower")?1:0),LP.lpprefsHasUserValue("genpw_digits")&&(S=LP.lpprefsGetBoolPref("genpw_digits")?1:0),LP.lpprefsHasUserValue("genpw_special")&&(E=LP.lpprefsGetBoolPref("genpw_special")?1:0),LP.lpprefsHasUserValue("genpw_mindigits")&&(P=LP.lpprefsGetIntPref("genpw_mindigits")?1:0),LP.lpprefsHasUserValue("genpw_ambig")&&(w=LP.lpprefsGetBoolPref("genpw_ambig")?1:0),LP.lpprefsHasUserValue("genpw_reqevery")&&(I=LP.lpprefsGetBoolPref("genpw_reqevery")?1:0),LP.lpprefsHasUserValue("genpw_pronounceable")&&(A=LP.lpprefsGetBoolPref("genpw_pronounceable")?1:0)):(C=parseInt(lpGetPref("generate_length",C)),h=parseInt(lpGetPref("generate_upper",h)),N=parseInt(lpGetPref("generate_lower",N)),S=parseInt(lpGetPref("generate_digits",S)),E=parseInt(lpGetPref("generate_special",E)),P=parseInt(lpGetPref("generate_mindigits",P)),w=parseInt(lpGetPref("generate_ambig",w)),I=parseInt(lpGetPref("generate_reqevery",I)),A=parseInt(lpGetPref("generate_pronounceable",A))),0==h&&0==N&&0==S&&0==E&&(h=N=S=1);var T=getpasswordfromacct(r);T.length>C&&(C=T.length);var W=Je(i);null!==W&&(void 0!==W.length&&null!==W.length&&(C=W.length),void 0!==W.maxlength&&null!==W.maxlength&&C>W.maxlength&&(C=W.maxlength),void 0!==W.minlength&&null!==W.minlength&&C<W.minlength&&(C=W.minlength),void 0!==W.special&&null!==W.special&&(E=W.special?1:0),void 0!==W.digits&&null!==W.digits&&(S=W.digits?1:0),void 0!==W.upper&&null!==W.upper&&(h=W.upper?1:0),void 0!==W.lower&&null!==W.lower&&(N=W.lower?1:0),void 0!==W.mindigits&&null!==W.mindigits&&(P=W.mindigits)),lt(Qi,"Generating a new password that is "+C+" chars long, "+(h?"with":"without")+" uppercase chars, "+(N?"with":"without")+" lowercase chars, "+(S?"with":"without")+" numeric chars, "+(E?"with":"without")+" special chars, with at least "+P+" numbers,");var F=g_isfirefox?LP.lpCreatePass:lpCreatePass,y=F(C,h,N,S,E,P,w,I,A);L("generated new password: "+(g_show_pw_in_logs||g_isadmin?y:"REDACTED")),L("saving "+(g_show_pw_in_logs||g_isadmin?y:"REDACTED")+" to "+l+" as generated password"),g_isfirefox?ff_save_generated_password(y,l,!0,!0):savePassword(y,l,e,1),g_isfirefox?null!==LP.lpgenpwlist&&LP.lpgenpwlist.unshift(y):null!==g_genpws&&g_genpws.unshift(y),CPWbot_bg.do_milestone(e,73,i),n.newpw=lpenc_acct(y,r,"undefined"==typeof g_shares?lpshares:g_shares),n.curpw=lpenc_acct(T,r,"undefined"==typeof g_shares?lpshares:g_shares),Vt=n,Kt=n.newpw,lt(Qi,"Filling Change-Password Form");var G=at(i),D=rnd2=rnd3=rnd4=0;Pi&&(D=Gt(),rnd2=Gt(),rnd3=Gt(),rnd4=Gt());var R=0;if(c&&(R+=1,re(e,T,c,_,G*R+D,o,m)),u&&(R+=1,re(e,y,u,_,G*R+D+rnd2,o,m)),p&&(R+=1,re(e,y,p,_,G*R+D+rnd2+rnd3,o,m)),b){oi=!0,L("now waiting for click_ack E");var U=null;void 0!==i.trigger_cpw_delay&&(U=i.trigger_cpw_delay),verbose_log("trigger cpw delay : "+U+" + "+G*R);var M=U;M=null===U?G*R:U+G*R+rnd4;var m=s(i);le(e,b,M,m),CPWbot_bg.mark_timestamp("wait_for_click_ack_E")}return pass,_e(e,i,k),t.didcallout?(L("end of trigger_cpw thread with callout to CS - hack Epickup to resume for aid="+a),Mt="Epickup",null):(L("no callout to CS, so trigger_cpw does not end thread, returning to initiate"),!0)},this.navigate_to_login=function(e,t){if(!t)return!1;var i=t.recipe;if(Mt="B",Qt=!1,!i)return!1;lt(Qi,"Navigate to Login");var _=n(i);if(_){L("call login:loadurl with "+_);var o=null;return g_CS_tops&&(o=g_CS_tops[e],g_ischrome&&0!=o&&L("loadurl is not sending to docnum==0 ! "+o)),sendCS(e,{cmd:"loadurl",url:_},o),sn=!0,verbose_log("m_in_loadurl set"),Jt=i,Vt=t,Qt=!0,null}return!g_v2engine&&(qe(i)&&(Qt=!0,xe(i))?null:(_e(e,i,y),!0))},this.check_is_logged_in=function(e,t,i){if(!t)return!1;var n={recipe:t,desc:"validate_website_is_loggedin",fn_required:Ae,fn_rejected:Te,fn_url_success:Me,fn_url_failed:Me};return CPWbot_bg.should_wait_for_document_complete(e,n)?(an=!0,CPWbot_bg.wait_for_doc_complete(e,null,Ue,n),null):(L("validate_website_is_loggedin returns true, no wait "),!0)},this.validate_login_success=function(e,t,i){if(!t)return!1;_e(e,t,R);var n={recipe:t,desc:"validate_login_success",fn_required:Se,fn_rejected:Le,fn_url_success:Z,fn_url_failed:Q};return CPWbot_bg.should_wait_for_document_complete(e,n)?(an=!0,CPWbot_bg.wait_for_doc_complete(e,null,Ue,n),null):(L("validate_login_success returns true, no wait "),!0)},this.validate_login_entry_success=function(e,t,i){if(!t)return!1;_e(e,t,x);var n={recipe:t,desc:"validate_login_entry_success",fn_required:Ee,fn_rejected:Pe,fn_url_success:ee,fn_url_failed:$};return CPWbot_bg.should_wait_for_document_complete(e,n)?(an=!0,CPWbot_bg.wait_for_doc_complete(e,null,Ue,n),null):(L("validate_login_entry_success returns true, no wait "),!0)},this.validate_cpw_success=function(e,t,i){if(!t)return!1;_e(e,t,U);var n={recipe:t,desc:"validate_cpw_success",fn_required:we,fn_rejected:Ie,fn_url_success:z,fn_url_failed:X};return CPWbot_bg.should_wait_for_document_complete(e,n)?(an=!0,CPWbot_bg.wait_for_doc_complete(e,null,Ue,n),null):(L("validate_cpw_success returns true, no wait "),!0)},this.validate_login_form=function(e,t,i){if(!t)return!1;var n={recipe:t,desc:"validate_login_form",fn_required:me,fn_rejected:ve,fn_url_success:Me,fn_url_failed:Me};return CPWbot_bg.should_wait_for_document_complete(e,n)?(an=!0,CPWbot_bg.wait_for_doc_complete(e,null,Ue,n),null):(L("validate_login_form returns true, no wait "),!0)},this.validate_cpw_form=function(e,t,i){if(!t)return!1;var n={recipe:t,desc:"validate_cpw_form",fn_required:pe,fn_rejected:be,fn_url_success:Me,fn_url_failed:Me};return CPWbot_bg.should_wait_for_document_complete(e,n)?(an=!0,CPWbot_bg.wait_for_doc_complete(e,null,Ue,n),null):(L("validate_cpw_form returns true, no wait "),!0)},this.validate_login_entry_form=function(e,t,i){if(!t)return!1;var n={recipe:t,desc:"validate_login_entry_form",fn_required:he,fn_rejected:Ne,fn_url_success:Me,fn_url_failed:Me};return CPWbot_bg.should_wait_for_document_complete(e,n)?(an=!0,CPWbot_bg.wait_for_doc_complete(e,null,Ue,n),null):(L("validate_login_entry_form returns true, no wait "),!0)},this.revert_password=function(e,t,i){return!!t&&(alert("REVERT: TODO"),!0)},this.initiate=function(e,t,i,n){},this.cpwbot_cs_finish_complete=function(e){if(verbose_log("cpwbot_cs_finish_complete on tabid="+e),jt!=e)return void(null!==jt&&verbose_log("stale call: started up a new password change on different tab - ABORT - tabid=="+e+" g_pwchangetabid="+jt));null!==CPWbot_bg.session_timeout_st_id&&clearTimeout(CPWbot_bg.session_timeout_st_id),CPWbot_bg.session_timeout_st_id=null,null!==CPWbot_bg.docaptcha_si_id&&clearInterval(CPWbot_bg.docaptcha_si_id),CPWbot_bg.docaptcha_si_id=null,CPWbot_bg.mark_timestamp("finish_complete"),CPWbot_bg.logout(),Ve(e),CPWbot_bg.do_milestone(e,66,null)},this.finish_cpwbot_validate_state=function(e,t,i,n,_){verbose_log("ENTERED finish_cpwbot_validate_state");var o,a=!1,r=!1;if(jt!=e)return verbose_log("finish_cpwbot_validate_state: !tabid, abort"),!1;if(t!=Yt){return verbose_log("finish_cpwbot_validate_state: ignoring stale request, current validate is "+xt+"/"+Yt+", stale req is "+_+"/"+t+" "),!1}var l=Jt,s=Re(l),c=Yt;if(gi&&!pi)return gi=!1,pi=!0,L("finish_cpwbot_validate_state: reload1 extending timeout for "+_),setTimeout(function(){CPWbot_bg.finish_cpwbot_validate_state(e,c,i,n,_)},s),!1;if(verbose_log("finish_cpwbot_validate_state: closing out request "+_+"/"+t),null===Xt)return verbose_log("finish_cpwbot_validate_state: dup, abort"),!1;if(null===g_CS[e])return lploggedin?(L("finish_cpwbot_validate_state: reload2 extending timeout for "+_),setTimeout(function(){CPWbot_bg.finish_cpwbot_validate_state(e,c,i,n,_)},s),!1):(verbose_log("finish_cpwbot_validate_state: tab "+e+" closed "),CPWbot_bg.panic("logged out?"),!1);var u=zt;for(g_CS[e].length==Xt.length&&(r=!0),o=0;o<Xt.length;o++)if(Xt[o]){a=!0;break}r||verbose_log("finish_cpwbot_validate_state: sent out "+g_CS[e].length+" messages, received "+Xt.length+" messages, skipped "+u+" frames");var d,f=0,g=0;for(d in fi)fi.hasOwnProperty(d)&&(this.skip_frame_by_score(d)||(f++,Xt[d]&&g++));if(g<f&&console_warn("CASE : still waiting to hear from important frames, expected to hear from "+f+", heard from "+g),!a){var p=JSON.parse(i),b=JSON.parse(n);0==p.length&&b.length>0&&(a=!0)}if(Xt=null,Bt=null,zt=0,g_v2engine)an=!1,Nn=!1,L("VALIDATE_IN_DOCWAIT=false"),Sn=a,Ln={},console_log("finish_cpwbot_validate_state complete result="+a+", wait for next engine cycle at "+Mt),pass;else{var m={aid:Ht,recipe:Jt,validate_result:a};console_log("finish_cpwbot_validate_state resumed initiate with state="+Mt),CPWbot_bg.initiate(e,m,Mt)}return!1},this.chk_cpw_resume=function(e,t){return!1},this.cpwbot_validate_state_result_handler=function(e,t){var i=!1;if(CPWbot_bg&&null!==jt&&e==jt){var n=t.docnum;if(void 0!==n&&CPWbot_bg&&null!==Xt){var _=JSON.parse(t.result),o=(JSON.parse(t.rejected_fields),JSON.parse(t.required_fields),!1),a=null;t.result_obj&&(a=JSON.parse(t.result_obj));var r=t.desc,l=t.id;if(L("received a "+r+" validate result from ["+e+"]["+n+"]["+t.url+"]["+t.docstate+"]["+t.state+"]="+_),xt&&xt!=r||Yt&&Yt!=l)return L("unexpected validate msg - perhaps from the last validate call.... ignoring it"),void L("got "+r+"/"+l+" expected "+xt+"/"+Yt);var s=!1;a&&(t.required_url&&lt(Xi,"["+e+"]["+n+"] validate given success_url, result="+a.url_success_match+" when matching success url = "+t.required_url),t.rejected_url&&lt(Xi,"["+e+"]["+n+"] validate given bad_url, result="+a.url_failure_match+" when matching failure url = "+t.rejected_url),lt(Xi,sprintf("[%s][%d] %s found %d/%d success fields, given %d invalid fields and %s invalid fields, %s captcha-ish fields",e,n,r,a.num_ok_matches,a.num_okfields,a.num_badfields,a.found_bad_match?"found":"did not find",a.found_interactive?"found":"did not find")),a.num_ok_matches>0?(pt(e,t),a.found_interactive&&(s=!0)):a.found_bad_match?(pt(e,t),s=!0):bt(e,t),a.found_interactive&&(o=!0)),Xt[n]=_;var c=mt(e);if(null===g_CS[e]&&CPWbot_bg&&Bt)return L("interrupted by a page load/refresh, reissuing validate for state "+Mt),Xt=[],void sendCS(e,Bt,"all");g_CS[e]&&g_CS[e].length==Xt.length&&(i=!0),null===g_CS[e]?verbose_log("tab is reloading but cannot retry validate ? WTF"):verbose_log("["+e+"] "+r+" sent "+g_CS[e].length+" messages, heard from "+Xt.length+", skipped "+c+" frames"),(_||i||s||o)&&(Xt=null,null===_&&(_=!1),Bt=null,an=!1,Nn=!1,L("VALIDATE_IN_DOCWAIT=false"),L("validate complete, result is "+_+" current state="+Mt),Sn=_,Ln=a)}else debug&&L("stale2? validate result tabid="+e+" g_pwchangetabid="+jt+" g_pwchange_validate_desc="+xt)}else debug&&L("stale1? validate result tabid="+e+" g_pwchangetabid="+jt+" g_pwchange_validate_desc="+xt)},this.cpwbot_finish_ack_handler=function(e,t){if(null!==e&&t)if(sendCS(e,{cmd:"cpwbot_finish_ack"},"all"),sendCS(e,{cmd:"hide_cpwbot_overlay"},"all"),g_CS_tops[e]==t.docnum)CPWbot_bg.cpwbot_cs_finish_complete(e);else{if(null==g_CS_tops[e]||void 0===g_CS_tops[e])console_error("webpage has not finished loading");else{console_error("WTF : top "+g_CS_tops[e]+" but docnum is "+t.docnum);var i=getcsinfo(e,t.docnum),n=getcsinfo(e,g_CS_tops[e]);n&&verbose_log("["+g_CS_tops[e]+"] topdoc is "+n.url),i&&verbose_log("["+t.docnum+"] other doc is "+i.url),i&&i.parent_docnum==i.docnum?verbose_log("CS table says that "+t.docnum+" is top"):n&&n.parent_docnum==n.docnum?verbose_log("CS table says that "+g_CS_tops[e]+" is top"):verbose_log("CS table mismatch, or reloading ? ")}CPWbot_bg.cpwbot_cs_finish_complete(e)}},this.cpwbot_skip_url=function(e,t){return!1},this.originating_tabid=null,this.destination_tabid=null,this.originating_tab=null,this.destination_tab=null,this.logout=function(){Mt=null,Ht=null,Jt=null,Vt=null,Bt=null,xt=null,Yt=null,Ut=0,jt=null,Kt=null,i(),_i=!1,ni=!1,fi=null,gi=!1,pi=!1,qt=null,this.clear_event_queue(),si=!1,ci=!1,ri=!1,li=!1,ui=!1,oi=!1,di=!1},this.initialize=function(e){if(!e)return void console_error("passed invalid params");jt=e.tabid,debug&&(In=e.tabid),Jt=e.recipe,Ht=e.aid,Mt=0,i(),ni=!1,oi=!1,_i=!1,g_robots_txt&&sendCS(e.tabid,{cmd:"get_robots_txt"},g_CS_tops[e.tabid]),fi={},gi=!1,pi=!1,qt=null,en="",bi=!1,mi=!1,Ci=!1,hi=!1,Ni=!1,Si=!1,Li=!1,rn=0,CPWbot_bg.clear_event_queue(),Gn=1,ft(),Ei=!1,CPWbot_bg.broken_hearted_st_id=null,sn=!1,cn=!1,un=!1,dn=!1,On=0,this.cpw_dialog_minimize_state=0},this.pwchangetabid_is_still_valid=function(){if(!CPWbot_bg)return!1;var e=jt;return!(null===e||!g_CS||void 0===g_CS[e]||null===g_CS[e])},this.panic=function(e){e||(e="UNEXPECTED ERROR"),L("panic="+e+", g_pwchangetabid == "+jt),CPWbot_bg.do_milestone(jt,128,Jt,e),ge(jt),CPWbot_bg.cpwbot_cs_finish_complete(jt)},this.setmsg_cpwbot_overlay=function(e,t){je(e,t)},this.initiate_on_complete=function(e,t,i){var n=null;if(!g_cpwbot||!CPWbot_bg||i>45)return CPWbot_bg.do_milestone(e,133,o,"initiate_on_complete"),CPWbot_bg.panic("TIMEOUT-initiate"),null;var _=t.aid,o=t.recipe;if(void 0!==i&&null!==i||(i=1),!ct(o)){var a=oe(_),r="(null)";a&&a.url&&(r=this.JSON.stringify(a.url));lt($i,"Bad Recipe");var l="Error for recipe on aid="+_+", url="+r,s={severity:"fatal",msg:"Bad Recipe"};return CPWbot_bg.phone_home(null,null,s),CPWbot_bg.panic(l),null}if(Fn)return void At(e,o);var c=rt(o);c||(c=900);var u=g_CS_tops[e];if(null!==u&&(n=getcsinfo(e,g_CS_tops[e]))&&"complete"==n.docstate){CPWbot_bg.mark_timestamp("doc_complete"),ping(e);var d=i?i*c/1e3:0;if(isNaN(d)&&verbose_log("WTF NaN: ctr="+i+" url="+r+" aid="+_),Dn){var f=Dn.doc_complete-Dn.openurl_callback;f>0&&0!=Dn.doc_complete&&Dn.openurl_callback&&(d=f/1e3)}return d>0&&lt(Xi,"Waited "+d+" seconds for document-complete before calling initialize_engine"),CPWbot_bg.initialize_engine(e,t)}return Fn||!lploggedin?(L("abort wait-for-doc-complete initiate"),!1):(null!==u?ping(e,u):ping(e),verbose_log("waiting for tabid "+e+" topdocnum="+u+" docstate="+(n?n.docstate:"null")),setTimeout(function(){CPWbot_bg.initiate_on_complete(e,t,i+1)},c),!0)},this.get_user_debug_messages=function(e,t){return ii};var Xi=0,Qi=1,Zi=2,$i=3;this.userlog=function(e,t){return lt(e,t)},this.click_ack_handler=function(e,t){var i=t.docnum,n=t.url,_=t.docstate,o=t.msgid,a=t.pwchangestate,r=t.found;return L("[T:"+e+"][D:"+i+"] cpwbot click_ack on "+t.id_value+" found="+r+" url="+n+" docstate="+_+" pwchangestate="+a),qt!=o?(console_error("response for last click request overlaps current click-wait, ignoring it, found="+r),L("m_pwchange_last_click_field_id="+qt),L("found="+r+" msgid = "+o),r&&console_error("Bad Mojo"),!0):(r&&(oi&&(oi=!1),ai&&(ai=!1),li&&(li=!1),ri&&(ri=!1),si&&(si=!1),ci&&(ci=!1),ui&&(ui=!1),di&&(di=!1)),!0)},this.fill_ack_handler=function(e,t){t.docnum,t.url,t.docstate,t.msgid,t.pwchangestate,t.found;return verbose_log(sprintf("[%s][%s] cpwbot fill ack on %s found=%s docstate=%s url=%s req_id=%s",e,t.docnum,t.id_value,t.found,t.docstate?t.docstate:"null",t.url?t.url:"null",t.req_id?t.req_id:"null")),!0},this.js_ack_handler=function(e,t){var i="";try{i=JSON.parse(t.result)}catch(e){console_warn("js_ack_handler: "+e)}return verbose_log(sprintf("[%s][%s] cpwbot js ack result=%s docstate=%s url=%s req_id=%s",e,t.docnum,i?ofa(i):"null",t.docstate?t.docstate:"null",t.url?t.url:"null",t.req_id?t.req_id:"null")),!0},this.check_for_robots=function(e,t,i){},this.check_robot_txt=function(e,t,i){if(g_robots_txt){if(!e)return!0;n(e);if(null===t)return void(g_tmp_recipe=e);var _,o=0,a=t.split("\n"),r=!1,l=!1;for(o=0;o<a.length;o++)_=a[o],(0==_.length&&""==_||"\r"==_)&&(r=!1,l=!1),"#"!=_.charAt(0)&&(0!=_.indexOf("User-agent: LastPass")&&0!=_.indexOf("User-agent: *")?0!=_.indexOf("Disallow: /")||(l=!0):r=!0);return!r||!l}},this.score_frame=function(e,t){var i,n=t.docnum,_=t.url,o=0,a=lp_gettld_url(_),r=0,l=["doubleclick.net","appads.com","crwdcntrl.net","googleadservices.com","quantserve.com","questionmarket.com","advertising.com","zedo.com","checkm8.com","zvents.com","doubleclick.com","yldmgrimg.net","optmd.com","casalemedia.com","scorecardresearch.com","quotemedia.com","tacoda.net","daylife.com","brightcove.com","wibiya.com","clickability.com","stats.com","google-analytics.com","adfusion.com","2mdn.net","adsonar.com","everyclick.com","shopica.com","yeah.com","vectorportal.com","cnomy.com","phpbb.com","tracking101.com","revsci.net","revsci.com","atdmt.com","mmismm.com","googlesyndication.com","247realmedia.com","pointroll.com","bluekai.com","serving-sys.com","vizu.com","cleanprint.com","outbrain.com","tweetmeme.com","visiblemeasures.com","starwave.com","kaango.com","gabriels.net","overture.com","yieldmanager.net","2mdn.com","eyewonder.com","imgdownloads.com","liverail.com","adnxs.com","addthis.com","addthiscdn.com","imshopping.com","adtech.de","2o7.net","glanceguide.com","performgroup.com","undertone.com","undertonevideo.com","martiniadnetwork.com","chartbeat.net","omtrdc.net","zoomflow.com","crowdscience.com","imrworldwide.com","fwmrm.net","tremormedia.com","webtrends.com","adzerk.net","adzerk.com","qubitproducts.com","maxymiser.net","maxymiser.com","newrelic.com","mathtag.com","adroll.com","criteo.com","liveperson.com","getclicky.com","sitemeter.com","displaymarketplace.com","yieldmanager.com","media6degrees.com","betrad.com","360yield.com","adpredictive.com","burstnet.com","adtechus.com","adsafeprotected.com","turn.com","contextweb.com","p-td.com","lijit.com","rubiconproject.com","ru4.com","admeld.com","openx.net","pubmatic.com","localyokelmedia.com","qnsr.com","wrating.com","audienceiq.com","mydas.mobi","mopub.com","visualrevenue.com","adsymptotic.com","admob.com","adtrking.com","4dsply.com","adshostnet.com","adziff.com","33across.com","vindicosuite.com","securepaths.com","taboola.com","trk4.com","crwdcntrl.com","connexity.com","connexity.net","effectivemeasure.net","visualdna.com","amazon-adsystem.com","4dsply.com","adblade.com","doubleverify.com","technoratimedia.com","adjuggler.com","opbandit.com","iesnare.com","adexcite.com","adadvisor.net","agkn.com","dntx.com","revenuehits.com","tribalfusion.com"],s=["ads.cnn.com","metrics.post-gazette.com","ads.nwsource.com","adbox.sina.com.cn","ads.sina.com.cn","ad.afy11.net","avatar.cnn.com","ads.cnn.com","metrics.apple.com","trailers.apple.com","metrics.philly.com","adsatt.espn.go.com","player.ooyala.com","seg.sharethis.com","edge.sharethis.com","bender.spoutable.com","engine.spoutable.com"],c=["facebook.com/plugins","facebook.com/connect/xd_arbiter","youtube.com/embed/","platform.twitter.com/widget","platform.twitter.com/tweet_button","libsyn.com/embed","amazon.com/gp/widget"];for(g_CS_tops&&g_CS_tops[e]==t.docnum&&(o=100),i=0;i<l.length;i++)if(a==l[i]){o=-100,r=1;break}if(!r)for(i=0;i<s.length;i++)if(_.indexOf(s[i])>=0){o=-100,r=1;break}if(!r)for(i=0;i<c.length;i++)if(_.indexOf(c[i])>=0){o=-100,r=1;break}return fi&&(fi[n]=o),o},this.score_topdoc=function(e,t,i){if(null===fi)return!1;null!==fi[t]&&void 0!==fi[t]||CPWbot_bg.clear_frame_score(e,t,i);var n=getcsinfo(e,t);return!!(n&&(state_param=n.flags,state_param&&state_param.has_frameset))||(fi[t]=fi[t]+100,!0)},this.clear_frame_score=function(e,t,i){return null!==fi&&(fi[t]=0,!0)},this.reset_scores=function(e){return fi=null,!0},this.skip_frame_by_score=function(e){if(null===fi||null===e)return!0;return L("skip? docnum ="+e+" score="+fi[e]),fi[e]<0},this.recompute_scores_for_tab=function(e){return!0},this.retry_validate=function(e,t){null===t&&(t="all"),Bt&&(Xt=[],sendCS(e,Bt,t))},this.wait_for_doc_complete=function(e,t,i,n,_,o){function a(e){return u?"complete"==e||"interactive"==e:"complete"==e}var r,l=n.aid,s=n.recipe,c=null,u=Ze(s);_||(_=0);var d=rt(n.recipe);d||(d=900);var f=g_CS_tops[e];if(void 0===f&&(f=null),null!==t&&void 0!==t||(t=f),null!==t&&(r=getcsinfo(e,t))&&(c=r.docstate,a(r.docstate)&&a(o))){var g=_?_*d/1e3:0;return isNaN(g)&&verbose_log("WTF NaN: recursion_ctr="+_+" aid="+l),g>0&&lt(Xi,sprintf("Waited %d seconds for %s on [tabid:%s][docnum:%d] to execute %s",g,u?"interactive":"complete",e,t,n.desc)),null!==CPWbot_bg.get_pwchangetabid()&&CPWbot_bg.in_validate()&&(Nn=!1,L("WAITED DONE, calling "+n.desc+" VALIDATE_IN_DOCWAIT=false")),i(e,n)}return Fn||!lploggedin||null===Mt?(L("abort wait-for-doc-complete "+n.desc),!1):(ping(e),verbose_log("waiting for tabid "+e+" topdocnum="+f+" passed_docnum="+t+" docstate="+(r?r.docstate:"null")+" last_state="+o),t!=f&&(console_error("edge case - top docnum changed due to page reload?  will wait for that instead"+t+"!="+f),t=f),setTimeout(function(){lploggedin&&CPWbot_bg&&CPWbot_bg.wait_for_doc_complete(e,t,i,n,_+1,c)},d),!0)},this.should_wait_for_document_complete=function(e,t){if(null===e||!t)return!1;var i=t.desc,n=t.recipe,_=!0,o=t.fn_url_failed,a=t.fn_url_success,r=t.fn_required,l=t.fn_rejected,s=r?r(n):[],c=l?l(n):[],u=t.target_url,d=t.target_field,f=t.target_js;if((void 0!==u&&null!==u||void 0!==d&&null!==d||void 0!==f&&null!==f)&&(_=!1),_){if(0==s.length&&0==c.length&&!a&&!o)return L("should_wait returns false, WARN: "+i+" has no field or url criteria defined to validate against"),!1}else if(!u&&!d&&!f)return L("should_wait returns false, no wait criteria, "+i),!1;return L("should_wait returns true for "+i+" is_validate="+_),!0},this.handle_challenge=function(e,t){},this.validate_challenge_page=function(e,t,i){if(!t)return!1;var n={recipe:t,desc:"validate_challenge_form",fn_required:Oe,fn_rejected:ke,fn_url_success:ie,fn_url_failed:te};return CPWbot_bg.should_wait_for_document_complete(e,n)?(an=!0,CPWbot_bg.wait_for_doc_complete(e,null,Ue,n),null):(L("validate_challenge_form returns false, no criteria to check, no wait"),!1)},this.force_validate_retry=function(e){gi=e},this.validate_challenge_success=function(e,t,i){if(!t)return!1;_e(e,t,j);var n={recipe:t,desc:"validate_challenge_success",fn_required:We,fn_rejected:Fe,fn_url_success:Me,fn_url_failed:Me};return CPWbot_bg.should_wait_for_document_complete(e,n)?(an=!0,CPWbot_bg.wait_for_doc_complete(e,null,Ue,n),null):(L("validate_challenge_success returns true, no wait "),!0)};var en="";this.set_dialog_msg=function(e){return en=e,!0},this.get_dialog_msg=function(){return en},this.clear_dialog_msg=function(){return en="",!0},this.get_failstate=function(){return Ci},this.get_okstate=function(){return hi},this.get_captchastate=function(){return Ni},this.get_docaptchastate=function(){return Si},this.get_brokenheartstate=function(){return Li},this.get_failpwsavedstate=function(){return yn},this.get_fail_pending=function(){return ni},this.get_success_pending=function(){return _i},this.show_selenium_ok=function(e){vt(e,"OK")},this.show_selenium_fail=function(e){vt(e,"FAIL")},this.preinit=function(){Mt="preinit",wi=Ii,i(),en="",ii="",null!==CPWbot_bg.broken_hearted_st_id&&clearTimeout(CPWbot_bg.broken_hearted_st_id),CPWbot_bg.broken_hearted_st_id=null,Fn=!1,Ni=!1,Si=!1,Ci=!1,Li=!1,hi=!1,yn=!1},this.do_milestone=function(e,t,i,n){var _=null;if(i||(i={symbolic:""}),wi=t,void 0!==n&&null!==n||(n=""),"undefined"!=typeof Date){var o="",a=(new Date).toString();if(zi[t]){var r=yt(i);r||(r=gs("unnamed site")),_=sprintf(zi[t],r)}switch(t){case 1:case 2:break;case Ai:case 8:break;case Ti:verbose_log("C: GOTO ACCTMGMT ");break;case Oi:verbose_log("D: REVEAL");break;case ki:verbose_log("E: TRIGGER");break;case Wi:verbose_log("F: VALIDATE");break;case Fi:se(e,i,Vt),_e(e,i,K),Si=!0,g_isfirefox&&je(e,gs("The website needs you to enter information. Please close this overlay and enter it."),i,!0),Ve(e),CPWbot_bg.session_timeout_st_id&&(clearTimeout(CPWbot_bg.session_timeout_st_id),CPWbot_bg.session_timeout_st_id=null),CPWbot_bg.docaptcha_si_id&&clearInterval(CPWbot_bg.docaptcha_si_id),CPWbot_bg.docaptcha_si_id=setInterval(function(){Si&&Ue(e,{desc:"docaptcha",recipe:i,fn_required:Ge})},1e3);break;case 63:lt(Qi,"Saved and Replaced"),hi=!0,(debug||g_isdebug)&&(lt(Qi,"showing selenium ok result"),CPWbot_bg.show_selenium_ok(e)),_i=!0,CPWbot_bg.mark_timestamp("success");break;case 65:g_v2engine?lt(Qi,sprintf("[%s] v2 %s",a,gs("BEGIN"))):lt(Qi,sprintf("[%s] %s",a,gs("BEGIN")));break;case 66:g_v2engine?lt(Qi,sprintf("[%s] v2 %s",a,gs("End").toUpperCase())):lt(Qi,sprintf("[%s] %s",a,gs("End").toUpperCase()));break;case 67:verbose_log("USER IS ALREADY LOGGED IN, SKIP LOGIN STATE"),lt(Qi,"Appears to be Logged Into Site");break;case Mi:case yi:lt(Qi,"Filling Login Form");break;case Ui:case Gi:lt(Qi,"Submit Login Form");break;case Di:lt(Qi,"Going to Login"),verbose_log("B: GOTO LOGIN");break;case Ri:lt(Qi,"Perform Logout");break;case 72:1!=Gn&&lt(Qi,sprintf("Adjusting for %s site, %6.2f",Gn>1?"slow":"fast",Gn));break;case 73:yn=!0,lt(Qi,"Generated Random Password and Saved to Vault");break;case 128:o="UNEXPECTED ERROR";break;case Ji:o="FILL LOGIN FORM [PW CHALLENGE] FAILED!";break;case Hi:o="SUBMIT LOGIN FORM [PW CHALLENGE] FAILED!";break;case Bi:o="Expected Change-Password Form";break;case 135:o="Change Password Failed";break;case Vi:o="Expected Login Form";break;case ji:case qi:o="Login to Website Failed!";break;case 136:o="Unable to Save New Password";break;case Yi:o="Unable to Log Out of Website";break;case 133:o=gs("Timed out waiting for the page to load.  Retry?"),Li=!0;break;case 140:o="Session Timeout";break;case xi:o="Halt Requested";break;case Ki:Ni=!0,o="Interaction required; cannot proceed";break;case Ii:default:_=""}if(128==(128&t)){Ci=!0,lt($i,o),(debug||g_isdebug)&&(lt(Qi,"showing selenium fail result"),CPWbot_bg.show_selenium_fail(e)),ni=!0,CPWbot_bg.mark_timestamp("fail");var l={severity:"fatal",msg:sprintf("%s[debug=%s]",o,n)};CPWbot_bg.phone_home(e,i,l),yn&&(_=sprintf(zi[248],yt(i)))}else 64==(64&t)&&(_="");if(_&&(je(e,_,i),CPWbot_bg.set_dialog_msg(_)),CPWbatch&&CPWbatch.cpw_get_batchjob_state()!=F_NONE){63==t?"OK":133==t||140==t?"TIMEOUT":128==(128&t)&&133!=t&&140!=t&&"FAIL"}return CPWbatch&&CPWbatch.conditional_website_status_update({tabid:e,recipe:i,state:t,msg:_}),!0}};var tn=null,nn=null,_n=null,on=null,an=!1,an=!1,rn=0,ln=[],sn=!1,cn=!1,un=!1,dn=!1,fn=!1,gn=!1,pn=!1,bn=!1,mn=!1,vn=!1,Cn=!1,hn=!1,Nn=null,Sn=null,Ln={},En=null,Pn=null,wn=null,In=null,An=null,Tn=null,On=0,kn=10,Wn=null,Fn=!1,yn=!1;this.broken_hearted_st_id=null,this.session_timeout_st_id=null,this.docaptcha_si_id=null;this.engine=function(e,t,i){function a(e){if(debug){var e=sprintf("[%s][%s] : %s",(new Date).toString(),"engine",e);console_log(e)}}function r(e,t,i){var n,_={aid:i.aid,recipe:i.recipe};verbose_log("do_C "+Mt),CPWbot_bg.do_milestone(e,Ti,t);var a={desc:"navigate_to_acctmgmt",didcallout:!1,payload:_,recipe:t,target_field:b(t),target_js:A(t)+""+T(t),target_url:o(t)};return CPWbot_bg.should_wait_for_document_complete(e,a)?(L("wrapped navigate_to_acctmgmt around wait-for-document-complete"),a.didcallout=!0,un=!0,CPWbot_bg.wait_for_doc_complete(e,null,function(e,t){L("Cnav milestone"),Mt="Cnav",En=t},a),n=null):(a.didcallout=!1,L("execute navigate_to_acctmgmt, no wait "),n=CPWbot_bg.navigate_to_acctmgmt(e,a)),null===n?(L("callout to CS : navigate_to_acctmgmt"),n):(!1===n&&console_error("C error"),L("execute navigate_to_acctmgmt, no wait "),c(e,t,i))}function l(e,t,i){ti=!1;var n=He(t);return n||(n=2500),n&&!bn?(Mt="Csleep",L("C sleeping "+n),ti=!0,nn=K,_n=K+n,bn=!0,null):(bn=!0,$t&&_e(e,t,T),c(e,t,i))}function c(e,t,i){verbose_log("do_D "+Mt);var n,o={aid:i.aid,recipe:i.recipe};dn=!1,CPWbot_bg.do_milestone(e,Oi,t);var a={desc:"reveal_cpw",payload:o,recipe:t,didcallout:!1,target_field:p(t),target_js:w(t)+""+I(t),target_url:_(t)};return CPWbot_bg.should_wait_for_document_complete(e,a)?(L("wrapped reveal_cpw around wait-for-document-complete"),a.didcallout=!0,dn=!0,CPWbot_bg.wait_for_doc_complete(e,null,function(e,t){L("Dreveal milestone"),Mt="Dreveal",En=t},a),n=null):(a.didcallout=!1,L("execute reveal_cpw, no wait "),n=CPWbot_bg.reveal_cpw(e,a)),n?(L("execute reveal_cpw, no wait "),C(e,t,i)):(L("callout to CS : reveal_cpw"),n)}function u(e,t,i){ti=!1;var n=Be(t);return n||(n=2500),n&&!mn?(Mt="Dsleep",L("D sleeping "+n),ti=!0,nn=K,_n=K+n,mn=!0,null):(mn=!0,Zt&&_e(e,t,I),d(e,t,i))}function d(e,t,i){L("entered do_D1");var n={aid:i.aid,recipe:t};Mt="D1";var _=null;return _=CPWbot_bg.validate_cpw_form(e,t,n),null===_?(verbose_log("D1: validate_cpw_form / CS callout "),Nn=!0,L("VALIDATE_IN_DOCWAIT=true"),null):_?void 0:f(e,t,i)}function f(e,t,i){var n={aid:i.aid,recipe:t};Mt="D2";var _=null;return _=CPWbot_bg.validate_login_form(e,t,n),null===_?(Nn=!0,L("VALIDATE_IN_DOCWAIT=true"),verbose_log("D2: validate_login_form / CS callout "),null):Le?g(e,t,i):(CPWbot_bg.do_milestone(e,Bi,t,""),ge(e),!1)}function g(e,t,i){Mt="D4",verbose_log("D4: FILL LOGIN/CHALLENGE");var n=null;return n=se(e,t,ie),n?m(e,t,i):(CPWbot_bg.do_milestone(e,Ji,t,""),ge(e),!1)}function m(e,t,i){verbose_log("D5: SUBMIT LOGIN"),Mt="D5";var n=1100,_=et(t);_&&(n=_),n&&verbose_log("waiting "+n+" ms after login waiting for site to bootstrap");var o=ce(e,t,ie);return!1===o?(CPWbot_bg.do_milestone(e,Hi,t,""),ge(e),!1):null===o?(n&&(ti=!0,nn=K,_n=K+n),null):C(e,t,i)}function C(e,t,i){verbose_log("do_E "+Mt);var n,_={aid:i.aid,recipe:i.recipe};CPWbot_bg.do_milestone(e,ki,t);var o={desc:"trigger_cpw",payload:_,recipe:t,target_field:v(t),target_js:O(t)+""+k(t),target_url:null};return CPWbot_bg.should_wait_for_document_complete(e,o)?(L("wrapped trigger_cpw around wait-for-document-complete"),o.didcallout=!0,cn=!0,CPWbot_bg.wait_for_doc_complete(e,null,function(e,t){L("Etrigger milestone"),Mt="Etrigger",En=t},o),n=null):(o.didcallout=!1,L("execute trigger_cpw, no wait "),n=CPWbot_bg.trigger_cpw(e,o)),n?(L("execute trigger_cpw, no wait "),N(e,t,i)):(L("callout to CS : trigger_cpw"),n)}function N(e,t,i){ti=!1;var n=Ye(t);return n||(n=2500),n&&!vn?(Mt="Esleep",L("E sleeping "+n),ti=!0,nn=K,_n=K+n,vn=!0,null):(vn=!0,i.validate_result=null,S(e,t,i))}function S(e,t,i){CPWbot_bg.mark_timestamp("verify_cpw"),CPWbot_bg.do_milestone(e,Wi,t),Mt="F";var n;return n=CPWbot_bg.validate_cpw_success(e,t,ie),null===n?(verbose_log("F: VALIDATE callout to CS"),Nn=!0,L("VALIDATE_IN_DOCWAIT=true"),null):(verbose_log("F: VALIDATE no callout to CS"),Tt("no verify-cpw criteria defined"),CPWbot_bg.panic("fail"),!1)}function E(e,t,i){CPWbot_bg.do_milestone(e,Ai,t);var n=h(t);if(n){Mt="A3R",verbose_log("A3R: login-form-reveal");var _=DEFAULT_CLICK_DELAY;void 0!==t.login_reveal_delay&&(_=t.login_reveal_delay),si=!0,L("now waiting for click_ack A3R");return le(e,n,_,s(t)),CPWbot_bg.mark_timestamp("wait_for_click_ack_A3R"),null}return P(e,t,i)}function P(e,t,i){L("post_A3R"),ti=!1;var n=xe(t);return verbose_log("A3R sleepval="+n),n||(n=1e3),n&&!gn?(Mt="A3Rsleep",L("A3R sleeping "+n),ti=!0,nn=K,_n=K+n,gn=!0,null):(gn=!0,i.validate_result=null,verbose_log("calling reveal JS after A3 state"),_e(e,t,y),W(e,t,i))}function W(e,t,i){CPWbot_bg.do_milestone(e,Ai,t);var n=!0;if(void 0!==i.check_login_entry_form&&(n=!!i.check_login_entry_form),Mt="A3",n&&Ce(t)){verbose_log("M: validate_login_entry_form"),CPWbot_bg.mark_timestamp("login_entry"),Mt="M";var _=null;if(verbose_log("calling validate_login_entry_form"),null===(_=CPWbot_bg.validate_login_entry_form(e,t,ie)))return verbose_log("M: validate_login_entry_form / CS callout "),Nn=!0,L("VALIDATE_IN_DOCWAIT=true"),null;verbose_log("M: validate_login_entry_form returns "+_+" no call to CS")}verbose_log("A3: validate_login_form"),Mt="A3";var o=null;return verbose_log("calling validate_login_form"),null===(o=CPWbot_bg.validate_login_form(e,t,ie))?(verbose_log("A3: validate_login_form / CS callout "),Nn=!0,L("VALIDATE_IN_DOCWAIT=true"),null):(verbose_log("A3: validate_login_form returns "+o+" no call to CS"),o?F(e,t,i):R(e,t,i))}function F(e,t,i){CPWbot_bg.mark_timestamp("login_cpw");verbose_log("A4: FILL LOGIN"),Mt="A4";var n=null;return n=se(e,t,ie),n?G(e,t,i):(CPWbot_bg.do_milestone(e,Vi,t,""),ge(e),!1)}function G(e,t,i){verbose_log("A5: SUBMIT LOGIN"),Mt="A5";var n=1100,_=et(t);_&&(n=_),n&&verbose_log("waiting "+n+" ms after login waiting for site to bootstrap");var o=ce(e,t,ie);return!1===o?(CPWbot_bg.do_milestone(e,ji,t,""),ge(e),!1):null===o?(n&&(ti=!0,nn=K,_n=K+n),null):D(e,t,i)}function D(e,t,i){verbose_log("A2: validate_login_success "),Mt="A2";var n=null;if(null===(n=CPWbot_bg.validate_login_success(e,t,ie)))return verbose_log("A2: validate_login_success / CS callout "),Nn=!0,L("VALIDATE_IN_DOCWAIT=true"),null;if(verbose_log("A2: validate_login_success "+n+" no CS callout "),!n)return CPWbot_bg.do_milestone(e,ji,t,re),ge(e),retval;if(g_cpw_do_fakeui){var _=Wt(e,t,i),o=at(t),a=o*_+1021;setTimeout(function(){r(e,t,i)},a)}else r(e,t,i)}function R(e,t,i){CPWbot_bg.mark_timestamp("navlogin_cpw"),Ut++,CPWbot_bg.do_milestone(e,Di,t);var n={aid:i.aid,recipe:i.recipe},_=CPWbot_bg.navigate_to_login(e,n);_&&U(e,t,i)}function U(e,t,i){verbose_log("post_B"),ti=!1;var n=xe(t);n||(n=1e3),n&&!pn?(Mt="Bsleep",L("B sleeping "+n),ti=!0,nn=K,_n=K+n,pn=!0):(pn=!0,i.desc="post_B/Breveal",i.validate_result=null,(g_v2engine||Qt)&&(verbose_log("calling reveal JS after B state"),_e(e,t,y)),fn=!0,CPWbot_bg.wait_for_doc_complete(e,null,function(e,t){L("B-reveal milestone"),Mt="B1Rpre",En=t},i))}function j(e,t,i){CPWbot_bg.do_milestone(e,Ri,t),Mt="L",CPWbot_bg.mark_timestamp("logout_cpw");var n=CPWbot_bg.navigate_to_logout(e,i);return null===n?verbose_log("L: navigate_to_logout / CS callout "):n?E(e,t,i):(CPWbot_bg.do_milestone(e,Yi,t,""),ge(e)),!0}function V(e,t,i){L("post_L"),ti=!1;var n=Ke(t);if(n||(n=1e3),n&&!Cn)return Mt="Lsleep",L("L sleeping "+n),ti=!0,nn=K,_n=K+n,Cn=!0,null;if(Cn=!0,ei&&_e(e,t,H),g_cpw_do_fakeui){var _=kt(e,t,i),o=at(t),a=o*_+1017;return setTimeout(function(){E(e,t,i)},a),null}return E(e,t,i)}function J(e,t,i){verbose_log("M5: SUBMIT LOGIN ENTRY"),Mt="M5";var n=1100,_=et(t);_&&(n=_),n&&verbose_log("waiting "+n+" ms after login waiting for site to bootstrap");var o=de(e,t,ie);return!1===o?(CPWbot_bg.do_milestone(e,qi,t,""),ge(e),!1):null===o?(n&&(ti=!0,nn=K,_n=K+n),null):B(e,t,i)}function B(e,t,i){verbose_log("M2: validate_login_entry_success "),Mt="M2";var n=null;return null===(n=CPWbot_bg.validate_login_entry_success(e,t,ie))?(verbose_log("M2: validate_login_entry_success / CS callout "),Nn=!0,L("VALIDATE_IN_DOCWAIT=true"),null):(verbose_log("M2: validate_login_entry_success "+n+" no CS callout "),n?(i.check_login_entry_form=!1,void W(e,t,i)):(CPWbot_bg.do_milestone(e,qi,t,re),ge(e),retval))}var Y=i.aid,x=i.recipe,K=(new Date).getTime(),q=!1;if(0==rn&&(CPWbot_bg.mark_timestamp("initial_cycle"),Pt(x),CPWbot_bg.do_milestone(e,72,x),null!==CPWbot_bg.broken_hearted_st_id&&clearTimeout(CPWbot_bg.broken_hearted_st_id),CPWbot_bg.broken_hearted_st_id=null,Ct(e,x)),rn++,a("engine awaken tick="+rn),null===Mt)return void ge(e);if(Fn||!lploggedin)return void At(e,x);if(!Si){var z=nt(x);z||(z=DEFAULT_SESSION_TIMEOUT);var X=CPWbot_bg.get_timestamp("docaptcha_success");if(X||(X=CPWbot_bg.get_timestamp("initial_cycle")),X||(X=tn),K>X+z*Gn)return q=!0,CPWbot_bg.do_milestone(e,140,x,"engine"),void CPWbot_bg.panic("TIMEOUT-engine")}var Q=Re(x);if(an&&on>0&&K>on+Q&&(St()?pass:(Nn=!1,L("ENGINE - VALIDATE_IN_DOCWAIT=false"),CPWbot_bg.finish_cpwbot_validate_state(e,Yt,Pn,wn,xt))),t&&ti){if(!(K>_n))return a("CONTINUE SLEEPING"),void Nt(e,Mt,i);a("AWAKEN FROM SLEEP")}var Z,$,ee=null;for(Z=0;Z<ln.length;Z++){$=ln[Z];var te=$.data.docnum;switch(a(sprintf("[%s][%d] processing event#%d cmd=%s",e,te,Z,$.data.cmd)),$.type){case"validate_response":CPWbot_bg.cpwbot_validate_state_result_handler($.tabid,$.data);break;case"fill_ack":CPWbot_bg&&CPWbot_bg.fill_ack_handler($.tabid,$.data);break;case"click_ack":CPWbot_bg&&CPWbot_bg.click_ack_handler($.tabid,$.data);break;case"js_ack":CPWbot_bg&&CPWbot_bg.js_ack_handler($.tabid,$.data);break;case"finish_ack":CPWbot_bg&&CPWbot_bg.cpwbot_finish_ack_handler($.tabid,$.data);break;case"loadurl":if(g_CS_tops&&g_CS_tops[e]==te)switch(sn&&(sn=!1,a("m_in_loadurl cleared")),a("loadurl/setprefs against top :"+g_CS_tops[e]+" == "+te+" start_state="+CPWbot_bg.get_pwchangestate()),Mt){case"A1":case"A2":case"A3":case"M":case"B1":case"F":CPWbot_bg&&Bt&&(CPWbot_bg.force_validate_retry(!0),CPWbot_bg.retry_validate(e));break;case"B1R":case"A3R":break;case"FK0":case"FKLL0":break;case 0:case"0":a("engine called in initial state - ignoring")}else null!==CPWbot_bg.get_pwchangetabid()&&CPWbot_bg.in_validate()?(L("processing loadurl event, reissue last validate to new doc ["+e+"]["+te+"]"),CPWbot_bg.retry_validate(e,te)):null!==CPWbot_bg.get_pwchangetabid()&&dt()&&(L("loadurl sent while waiting for a click, issue last click to new frame"+te),hn=!0,Lt(e,te));break;case"unload":break;default:a("need to handle this msg: "+$.data.cmd)}}CPWbot_bg.clear_event_queue(),a("current state is "+Mt);var ie=Vt;switch(Mt&&null===ie&&(ie={aid:Y}),Mt){case 0:!function(e,t,n){Mt="A1";var _=CPWbot_bg.check_is_logged_in(e,t,n);null===_?(verbose_log("A1: check_is_logged_in / CS callout "),Nn=!0,L("VALIDATE_IN_DOCWAIT=true")):(verbose_log("A1: check_is_logged_in returns "+_+" no CS callout "),ee=Sn,_=ee,_?vi?j(e,t,i):r(e,t,i):E(e,t,i))}(e,x,ie);break;case"A1":if(CPWbot_bg.in_validate()||Nn)a("waiting for validate to end, "+Mt),pass;else if(un)a("waiting for doc-complete for Cnav, "+Mt),pass;else if(an)a("A1: wait on m_in_validate");else{ee=Sn;var ne=ee;ne?vi?(CPWbot_bg.do_milestone(e,67,x),j(e,x,i)):(verbose_log("short-circuiting logout/L state"),CPWbot_bg.do_milestone(e,67,x),r(e,x,i)):null===ne?CPWbot_bg.alert("A1 unexpected"):E(e,x,i)}break;case"A3R":si?(a("waiting for click_ack, "+Mt),Et(e),pass):sn?(a("waiting for loadurl , "+Mt),pass):P(e,x,i);break;case"B1Rpre":!function(e,t,i){ci=!1;var n=h(t);if(n){Mt="B1R",verbose_log("B1R: login-form-reveal"),verbose_log("click on FN_REVEAL_LOGIN field!");var _=DEFAULT_CLICK_DELAY;return void 0!==t.login_reveal_delay&&(_=t.login_reveal_delay),ci=!0,verbose_log("now waiting for click_ack B1R"),le(e,n,_,s(t)),CPWbot_bg.mark_timestamp("wait_for_click_ack_B1R"),null}ht(e,t,i)}(e,x,i);break;case"B1R":ci?(a("waiting for click_ack, "+Mt),Et(e),pass):sn?(a("waiting for loadurl , "+Mt),pass):an?a("B1R: wait on m_in_validate"):ht(e,x,i);break;case"B1":if(CPWbot_bg.in_validate()||Nn)a("waiting for validate to end, "+Mt),pass;else if(an)a("B1: wait on m_in_validate");else{ee=Sn;var ae=ee;if(Ln&&Ln.found_interactive)return console_error("B1: found interactive field"),void Ft(e,x);if(!ae){debug&&g_innerHTML_debug&&Ln.innerhtml&&verbose_log("VALIDATE FAILURE, final innerHTML is "+Ln.innerhtml);var re="";return CPWbot_bg.do_milestone(e,Vi,x,re),void ge(e)}F(e,x,i)}break;case"A2":if(CPWbot_bg.in_validate()||Nn)a("waiting for validate to end, "+Mt),pass;else if(an)a("A2: wait on m_in_validate");else if(un)a("A2: wait on navigate");else{
if(Ln&&Ln.found_interactive)return console_error("A2: found interactive field"),void Ft(e,x);ee=Sn;var pe=ee;if(!pe){var re="";return CPWbot_bg.do_milestone(e,ji,x,re),void ge(e)}r(e,x,i)}break;case"A3":if(CPWbot_bg.in_validate()||Nn||an)a("waiting for validate to end, "+Mt),pass;else{ee=Sn;var ae=ee;if(Ln&&Ln.found_interactive)return console_error("A3: found interactive field"),void Ft(e,x);ae?(a("A3: has login form, calling do_A4"),Ln&&Ln.found_interactive&&a("A3: found_interactive=true"),F(e,x,i)):(debug&&g_innerHTML_debug&&Ln.innerhtml&&verbose_log("VALIDATE FAILURE, final innerHTML is "+Ln.innerhtml),R(e,x,i))}break;case"M":if(CPWbot_bg.in_validate()||Nn||an)a("waiting for validate to end, "+Mt),pass;else{ee=Sn;var be=ee;if(Ln&&Ln.found_interactive)return console_error("M: found interactive field"),void Ft(e,x);be?function(e,t,i){CPWbot_bg.mark_timestamp("login_entry"),verbose_log("M4: FILL LOGIN"),Mt="M4";var n=null;n=ue(e,t,ie),n?J(e,t,i):(CPWbot_bg.do_milestone(e,Vi,t,""),ge(e))}(e,x,i):(verbose_log("did not find initial stage login form"),Ln.innerhtml&&verbose_log("final innerHTML is "+Ln.innerhtml),i.check_login_entry_form=!1,W(e,x,i))}break;case"M2":if(CPWbot_bg.in_validate()||Nn)a("waiting for validate to end, "+Mt),pass;else if(an)a("M2: wait on m_in_validate");else if(un)a("M2: wait on navigate");else{if(Ln&&Ln.found_interactive)return console_error("M2: found interactive field"),void Ft(e,x);ee=Sn;var pe=ee;if(!pe){var re="";return Ln&&(re=sprintf("found_bad_match=%s, num_ok_matches=%s, retval=%s, url_success_match=%s, url_failure_match=%s",Ln.found_bad_match,Ln.num_ok_matches,Ln.retval,Ln.url_success_match,Ln.url_failure_match)),CPWbot_bg.do_milestone(e,qi,x,re),void ge(e)}i.check_login_entry_form=!1,W(e,x,i)}break;case"A4":break;case"A5":D(e,x,i);break;case"M5":B(e,x,i);break;case"A":console_warn("engine state=A todo");break;case"B":sn?(a("waiting for loadurl to complete, "+Mt),pass):fn?(a("waiting for doc-complete after loadurl, "+Mt),pass):U(e,x,i);break;case"Bsleep":fn?(a("waiting for doc-complete after loadurl, "+Mt),pass):U(e,x,i);break;case"C":if(ri)a("waiting for click_ack, "+Mt),Et(e),pass;else if(sn)a("waiting for loadurl , "+Mt),pass;else if(dn)a("waiting for reveal-cpw doc-complete, "+Mt),pass;else{var me=g_CS_tops[e];void 0===me&&(me=null);var ve=null;if(null!==me)if(ve=getcsinfo(e,me)){var he=ve.docstate;"complete"==ve.docstate&&"complete"==he?(a("C: wait completed "+Mt),l(e,x,i)):a("C: wait docstate:"+ve.docstate+",last:"+he)}else a("C: fail");else a("C: wtf - wait for page to finish loading?");null!==me?ping(e,me):ping(e)}break;case"Cnav":L("aid = "+En.payload.aid),CPWbot_bg.navigate_to_acctmgmt(e,En),En=null;break;case"Cpickup":ri&&(L("still waiting for click-C"),a("waiting for click_ack, "+Mt),Et(e)),dn?L("still waiting for document-complete to run reveal_cpw"):l(e,x,i);break;case"A3Rsleep":P(e,x,i);break;case"B1Rsleep":W(e,x,i);break;case"Csleep":dn?L("still waiting for document-complete to run reveal_cpw"):l(e,x,i);break;case"Dpickup":iscpwfast()&&CPWbatch.conditional_website_status_update({aid:Y,state:76,msg:"SLOW"}),li?(L("still waiting for click-D"),a("waiting for click_ack, "+Mt),Et(e)):u(e,x,i);break;case"Dsleep":u(e,x,i);break;case"Epickup":iscpwfast()&&CPWbatch.conditional_website_status_update({aid:Y,state:76,msg:"SLOW"}),oi?(L("still waiting for click-E"),a("waiting for click_ack, "+Mt),Et(e)):(i.validate_result=null,N(e,x,i));break;case"Esleep":i.validate_result=null,N(e,x,i);break;case"D":if(a("engine handle D"),li||sn)li?(a("waiting for click_ack, "+Mt),Et(e)):a("waiting for load to complete, "+Mt),pass;else{var me=g_CS_tops[e];void 0===me&&(me=null);var ve=null;if(null!==me)if(ve=getcsinfo(e,me)){var he=ve.docstate;"complete"==ve.docstate&&"complete"==he?(a("D: wait completed "+Mt),u(e,x,i)):a("D: wait docstate:"+ve.docstate+",last:"+he)}else a("D: fail");else a("D: wtf - wait for page to finish loading?");null!==me?ping(e,me):ping(e)}break;case"Dreveal":CPWbot_bg.reveal_cpw(e,En);En=null;break;case"D1":if(CPWbot_bg.in_validate()||Nn)a("waiting for validate to end, "+Mt),pass;else if(an)a("D1: wait on m_in_validate");else if(cn)a("D1: wait on doc-complete for trigger_cpw");else{ee=Sn;var Ne=ee;if(Ln&&Ln.found_interactive)return console_error("D1: found interactive field"),void Ft(e,x);Ne?C(e,x,i):f(e,x,i)}break;case"D2":if(CPWbot_bg.in_validate()||Nn)a("waiting for validate to end, "+Mt),pass;else if(an)a("D2: wait on m_in_validate");else{ee=Sn;var Se=ee;if(!Se){var re="";return CPWbot_bg.do_milestone(e,Bi,x,re),void ge(e)}g(e,x,i)}break;case"D4":break;case"D5":ai?(a("waiting for click_ack, "+Mt),Et(e)):cn?a("D5: wait on doc-complete for trigger_cpw"):C(e,x,i);break;case"D3":console_error("D3 reached - should not happen");break;case"D_validate_cpw_form":Ue(e,En),En=null;break;case"E":console_error("E: should not occur");break;case"Etrigger":oi?(a("waiting for click_ack, "+Mt),Et(e)):sn?console_error("Etrigger: m_in_loadurl should not happen"):an?console_error("Etrigger: m_in_validate should not happen"):(CPWbot_bg.trigger_cpw(e,En),En=null);break;case"F":if(CPWbot_bg.in_validate()||Nn)a("waiting for validate to end, "+Mt),pass;else if(sn)a("waiting for loadurl and doc-complete"),pass;else if(an)a("F: wait on m_in_validate"),pass;else{CPWbot_bg.bagration(),ee=Sn;var Le=ee;if(null!==Le){verbose_log("F: VALIDATE return from CS, returned "+Le),debug&&g_innerHTML_debug&&Sn.innerhtml&&!Le&&verbose_log("VALIDATE FAILURE, final innerHTML is "+Sn.innerhtml);var re="";if(Le)if(verbose_log("cpwbot initiate: validate cpw succeeded, now updating user record"),fe(e,x,ie)){CPWbot_bg.do_milestone(e,63,x);var Ee,Pe=oe(Y),Ee=lpdec_acct(Kt,Pe,"undefined"==typeof g_shares?lpshares:g_shares),we=n(x),Ie=lp_gettld_url(we);verbose_log('remember to g_didchangepw for pw="'+(g_show_pw_in_logs||g_isadmin?Ee:"REDACTED")+'" tld='+Ie),remember_changed_pw(Ee,Ie)||verbose_log('save to g_didchangepw failed for pw="'+(g_show_pw_in_logs||g_isadmin?Ee:"REDACTED")+'" tld='+Ie),function(e,t,i){if(M(t)){var n=1234,_=it(t);_&&(n=_),setTimeout(function(){CPWbot_bg.conditional_js_exec(e,t,M)},n)}console_error("The End.")}(e,x)}else CPWbot_bg.do_milestone(e,136,x,re);else CPWbot_bg.do_milestone(e,135,x,re)}ge(e),q=!0}break;case"G":break;case"L":if(ui)a("waiting for click_ack, "+Mt),Et(e),pass;else if(sn)a("waiting for loadurl , "+Mt),pass;else{var me=g_CS_tops[e];void 0===me&&(me=null);var ve=null;null!==me&&(ve=getcsinfo(e,me),ve?"complete"==ve.docstate&&(a("L: wait completed "+Mt),V(e,x,i)):a("L: fail")),null!==me?ping(e,me):ping(e)}break;case"Lsleep":V(e,x,i);break;case"Bagration":case"FK0":case"FK1":case"FK2":case"FKI":break;case"FK3":E(e,x,i);break;case"FKLL0":case"FKLL1":case"FKLL2":case"FKLLI":break;case"FKLL3":r(e,x,i);break;default:pass}q||Nt(e,Mt,i)},this.initialize_engine=function(e,t){tn=(new Date).getTime();var i=t.recipe;t.aid;Vt=t,CPWbot_bg.mark_timestamp("initialize_engine");sn=!1,cn=!1,un=!1,dn=!1,fn=!1,m_in_logout_reveal=!1,gn=!1,pn=!1,bn=!1,mn=!1,vn=!1,Cn=!1,ti=!1,an=!1,yn=!1,CPWbot_bg.do_milestone(e,65,i);var n=$e(i);if(n)bi||(bi=!0,setTimeout(function(){return Nt(e,0,t),!1},n));else if(V(i)&&!mi){var _=5e3,o=tt(i);o&&(_=o),mi=!0,verbose_log("initial JS inject before beginning - inject, and wait "),CPWbot_bg.conditional_js_exec(e,i,V),setTimeout(function(){return Nt(e,0,t),!1},_)}else Nt(e,0,t)},this.push_event_queue=function(e,t,i){if("validate_response"==e&&void 0!==i.desc&&"docaptcha"==i.desc)return void(Si&&JSON.parse(i.result_obj).num_ok_matches>0&&(CPWbot_bg.mark_timestamp("docaptcha_success"),_e(t,Jt,q),Si=!1,CPWbot_bg.show_cpwbot_overlay(t,null,null),Ct(t,Jt),Bt=null,an=!1,Ln.found_interactive=!1,Sn=!0,Nt(t,Mt,Vt)));var n={};n.type=e,n.data=i,n.tabid=t,n.docnum=i.docnum,n.addtime=new Date,null===ln&&(ln=[]),void 0!==n.docnum&&verbose_log(sprintf("[%s][%d] pushed event : %s cmd=%s",t,n.docnum,e,i.cmd)),ln.push(n)},this.clear_event_queue=function(){ln=[]},this.select_execute=function(e,t,i,n){},this.select=function(){},this.bagration=function(){Mt="Bagration"},this.in_bagration=function(){return"Bagration"==Mt},this.get_selenium_tabid=function(){return In},this.navigate_to_logout=function(e,t){if(!t)return!1;Mt="L",ei=!1;var i=t.recipe;if(!i)return!1;var n=(t.aid,!1),_=!1;_=_e(e,i,J),lt(Qi,"Navigate to Logout");var o=a(i);if(o){L("call logout:loadurl with "+o);var r=null;return g_CS_tops&&(r=g_CS_tops[e]),sendCS(e,{cmd:"loadurl",url:o},r),sn=!0,verbose_log("m_in_loadurl set"),Jt=i,Vt=t,ei=!0,null}ui=!1;var l=m(i);if(l){verbose_log("click on FN_NAVIGATE_TO_LOGOUT field!");var c=DEFAULT_CLICK_DELAY;void 0!==i.logout_delay&&(c=i.logout_delay),ui=!0,verbose_log("now waiting for click_ack L");le(e,l,c,s(i)),CPWbot_bg.mark_timestamp("wait_for_click_ack_L"),n=null}return Qe(i)&&(ei=!0,Ke(i))?null:(_=_||_e(e,i,H),!1===n&&_&&(n=!0),n)};var Gn=1,Dn=null;return this.get_timestamp=function(e){return e?(null===Dn&&(Dn=new It),Dn[e]):null},this.get_timestamps=function(){return Dn},this.mark_timestamp=function(e){null!==Dn&&"dopwchange"!=e||(Dn=new It);var t=(new Date).getTime();return Dn[e]=t,!0},this.dump_timestamps=function(){var e;if(Dn)for(e in Dn)L(sprintf("[%s] timestamp %s : %d",yt(Jt),e,Dn[e]));return wt(Jt,Gn),!0},this.get_last_timestamp=function(e){var t,i="dopwchange";if(Dn){for(t in Dn)(!e||"fail"!==t&&"finish_complete"!=t&&"success"!=t)&&Dn[t]>Dn[i]&&(i=t);return i}return null},this.broken_hearted=function(e){if(CPWbot_bg){if(e!=CPWbot_bg.get_session())return void lt(Xi,"stale setTimeout - clearTimeout did not work");var t=CPWbot_bg.get_timestamp("initial_cycle");(new Date).getTime();if(void 0===t&&(t=null),!(t||"preinit"!=Mt&&Mt||CPWbot_bg.get_okstate()||CPWbot_bg.get_failstate()||CPWbot_bg.in_bagration())){var i=jt,n=Jt;CPWbot_bg.do_milestone(i,133,n,"brokenhearted"),CPWbot_bg.panic("TIMEOUT-brokenhearted")}}else;},this.new_session=function(e){e||(e="");var t=(new Date).getTime();null===t&&(t=0);var i="function"==typeof lp_sha256?lp_sha256:SHA256;return Wn=i(e.toString()+t.toString())},this.get_session=function(){return Wn},this.clear_session=function(){Wn=""},this.halt=function(e){if(e&&void 0!==e.aid&&CPWbot_bg.getpwchangeaid()!==e.aid)return!1;null!==CPWbot_bg.docaptcha_si_id&&clearInterval(CPWbot_bg.docaptcha_si_id),CPWbot_bg.docaptcha_si_id=null,Fn=!0,L("Halt Requested")},this.cpw_dialog_minimize_state=0,this.getpwchangeaid=function(){return Ht},this.phone_home=function(e,t,i){if(!i)return!1;t||(t=Jt);var n=(new Date).getTime(),_=(n-CPWbot_bg.get_timestamp("dopwchange"))/1e3;(_<0||isNaN(_))&&(_=0);var o=(n-CPWbot_bg.get_timestamp("initial_cycle"))/1e3;(o<0||isNaN(o))&&(o=0);var a=CPWbot_bg.get_last_timestamp(!0),r=i.severity?i.severity:"",l=i.msg?i.msg:"",s=sprintf("[%s][%s][R=%s][L=%s][M=%s][%6.2fsec elapsed][%2.1f TF][%6.2fsec TiE]","cpw",r,t?yt(t):"bad-recipe",a,l,_,Gn,o);return L(s),lpReportError(s,null),!0},this.warning_phone_home=function(e){return Ot(e)},this.site_html_url="","undefined"!=typeof g_iscasper&&g_iscasper&&(this.get_validate_timeout=function(e){return Re.apply(this,arguments)},this.get_symbolic=function(e){return yt.apply(this,arguments)},this.get_logout_url=function(e){return a.apply(this,arguments)},this.get_generate_prefs_from_recipe=function(e){return Je.apply(this,arguments)},this.set_last_overlay_message=function(e){return t.apply(this,arguments)},this.clear_last_overlay_message=function(e){return i.apply(this,arguments)},this.validate_xpath=function(e){return st.apply(this,arguments)},this.validate_recipe=function(e){return ct(e)},this.get_cpw_login_password_field=function(e){return c.apply(this,arguments)},this.get_cpw_login_username_field=function(e){return u.apply(this,arguments)},this.get_login_submit_field=function(e){return C.apply(this,arguments)},this.get_login_reveal_field=function(e){return h.apply(this,arguments)},this.replace_constants=function(e){return replace_constants.apply(this,arguments)},this.set_pwchangestate=function(e){return Mt=e,!0},this.in_wait_for_click=function(){return dt()},this.submit_login_form=function(e,t,i){return ce(e,t,i)},this.fill_login_form=function(e,t,i){return se(e,t,i)},this.clear_wait_for_clicks=function(){return ft()},this.get_event_queue=function(){return ln},this.reset_private_test_vars=function(){Ei=!1,an=!1,Nn=!1},this.should_click_on_fill=function(e){return _t(e)},this.should_fill_password_fields_via_keys=function(e){return ot(e)},this.get_fill_delay=function(e){return at(e)},this.random_delay=function(e){return Gt(e)},this.random_sleep=function(e,t){return Dt(e,t)},this.get_cpw_session_timeout=function(e){return nt(e)},this.fill_login_entry_form=function(e,t,i){return ue(e,t,i)},this.submit_login_entry_form=function(e,t,i){return de(e,t,i)},this.set_pwchange_validate_desc=function(e){return xt=e,!0},this.check_recipe_symbols=function(e){return ut(e)},this.set_in_validate_outer=function(){return an=!0,Nn=!0,!0},this.set_in_validate_inner=function(e,t){Bt={cmd:"cpwbot_validate_state",desc:t,id:e},Yt=e,Rt.set_pwchange_validate_desc(t),null===Xt&&(Xt=[])},this.get_in_sleep=function(){return ti},this.clear_sleeps=function(){gn=!1,pn=!1,bn=!1,mn=!1,vn=!1,Cn=!1,ti=!1}),!0}function get_recipe_for_url(e,t){var i,n;lp_gettld_url(e);return g_isfirefox?(i=LP.lpMakeRequest,n=LP.lp_base):(i=lpMakeRequest,n=base_url),void i(n+"get_recipe.php","url="+encodeURIComponent(e),function(e){if(4==e.readyState){if(200==e.status&&null!=e.responseXML&&null!=e.responseXML.documentElement){var i=e.responseXML.documentElement.getElementsByTagName("result");if(i.length>0){var n=i[0].getAttribute("recipe");if(""!=n)return void t(replace_constants(JSON.parse(n)));CPWbatch&&CPWbatch.cpw_get_batchjob_state()||CPWbot_bg.alert("This url is not supported yet");CPWbot_bg.do_milestone(null,128,null,"no recipe")}}t(null)}},function(){t(null)})}function ping_ack_handler(e,t){var i=t.docnum,n=t.url,_=t.id,o=t.delta,a=(new Date).getTime(),r=a-t.timestamp;debug&&L("received ping response from [tabid:"+e+"][docnum:"+i+"][id:"+_+" sent: "+o+"ms, response: "+r+"ms docstate="+t.docstate+" url="+n);var l=getcsinfo(e,i);l||(l=new CS_t,l.docnum=i,l.tabid=e),l.url=n,l.docstate=t.docstate,l.flags=t.flags,setcsinfo(e,i,l)}function ping(e,t){var i=(new Date).getTime(),n=!1;void 0!==e&&null!==e||(n=!0),void 0!==t&&null!==t||(t="all");var _="function"==typeof lp_sha256?lp_sha256:SHA256,o=_(g_username+""+e+t+i);if(debug&&L("sending ping id="+o),n)for(e in g_CS)void 0!==e&&null!==e&&sendCS(e,{cmd:"ping_req",id:o,timestamp:i},t);else sendCS(e,{cmd:"ping_req",id:o,timestamp:i},t)}function cpwbot_getpwchangestate(){return g_cpwbot&&CPWbot_bg?"Bagration"==CPWbot_bg.get_pwchangestate()?!0===CPWbot_bg.get_failstate()?!0===CPWbot_bg.get_failpwsavedstate()?"FAIL_PW_SAVED":"FAIL":!0===CPWbot_bg.get_okstate()?"OK":null:!0===CPWbot_bg.get_captchastate()?"CAPTCHA":!0===CPWbot_bg.get_docaptchastate()?"DOCAPTCHA":!0===CPWbot_bg.get_brokenheartstate()?"TIMEOUT":"preinit"==CPWbot_bg.get_pwchangestate()?null:!0===CPWbot_bg.get_failstate()?!0===CPWbot_bg.get_failpwsavedstate()?"FAIL_PW_SAVED":"FAIL":!0===CPWbot_bg.get_okstate()?"OK":CPWbot_bg.get_pwchangestate():"FAIL"}function cpwbot_preinit(){CPWbot_bg&&CPWbot_bg.preinit()}function cpwbot_get_user_debug_messages(){if(CPWbot_bg)return CPWbot_bg.get_user_debug_messages()}function cpwbot_get_dialog_msg(){if(CPWbot_bg)return CPWbot_bg.get_dialog_msg()}function cpwbot_halt(){if(CPWbot_bg)return CPWbot_bg.halt()}function cpwbot_minimize_dialog(){CPWbot_bg&&(CPWbot_bg.cpw_dialog_minimize_state=1)}function cpwbot_maximize_dialog(){CPWbot_bg&&(CPWbot_bg.cpw_dialog_minimize_state=0)}function cpwbot_get_minimize_dialog_state(){if(CPWbot_bg)return CPWbot_bg.cpw_dialog_minimize_state}var CPWbot_bg,g_v2engine=!0,g_v3engine=!1;CPWbot_bg||(CPWbot_bg=new CPWbot_bg_lib);var g_cpw_server_initiated_tabid=null,g_cpw_do_fakeui=!1,TYPE_ID="id",TYPE_NAME="name",TYPE_XPATH="xpath",FN_LOGIN=1,FN_PASSWORD=2,FN_LOGIN_OTHER=5,FN_CURRENT_PASS=10,FN_NEW_PASS=11,FN_NEW_PASS_CONFIRM=12,FN_CPW_OTHER=13,FN_CPW_INVALID=14,FN_LOGIN_INVALID=15,FN_LOGIN_SUCCESS=16,FN_LOGIN_SUCCESS_INVALID=17,FN_NAVIGATE_TO_CPW=18,FN_CPW_SUCCESS=19,FN_CPW_SUCCESS_INVALID=20,FN_NAVIGATE_TO_ACCTMGMT=21,FN_CPW_SUBMIT=22,FN_IS_LOGGED_IN=23,FN_IS_LOGGED_IN_NEGATION=24,FN_LOGIN_SUBMIT=25,FN_POPUP_EXISTS=26,FN_POPUP_DISMISS=27,FN_REVEAL_LOGIN=28,FN_CHALLENGE_LOGIN=29,FN_CHALLENGE_PASSWORD=30,FN_CHALLENGE_OTHER=31,FN_CHALLENGE_SUBMIT=32,FN_CHALLENGE_INVALID=33,FN_CHALLENGE_SUCCESS=34,FN_CHALLENGE_SUCCESS_INVALID=35,FN_EPHEMERAL_STATE=37,FN_NAVIGATE_TO_LOGOUT=38,FN_CAPTCHA=39,FN_MULTI_FACTOR=40,FN_PASSWORD_HINT=41,FN_POPUP_EXISTS_INVALID=42,FN_FAKEUI_LOGGED_OUT_1=43,FN_FAKEUI_LOGGED_OUT_2=44,FN_FAKEUI_LOGGED_OUT_3=45,FN_FAKEUI_LOGGED_OUT_INPUT=46,FN_FAKEUI_LOGGED_IN_1=47,FN_FAKEUI_LOGGED_IN_2=48,FN_FAKEUI_LOGGED_IN_3=49,FN_FAKEUI_LOGGED_IN_INPUT=50,FN_FORCE_FAIL=51,FN_CAPTCHA_SUCCESS=52,FN_MULTI_FACTOR_SUCCESS=53,FN_PASSWORD_HINT_SUCCESS=54,FN_LOGIN_ENTRY_INVALID=55,FN_LOGIN_ENTRY_USERNAME=56,FN_LOGIN_ENTRY_SUBMIT=57,FN_LOGIN_ENTRY_PASSWORD=58,FN_LOGIN_ENTRY_SUCCESS_INVALID=59,FN_LOGIN_ENTRY_SUCCESS=60,FN_REVEAL_LOGOUT=61,CONST_CLICK_NOMINAL=0,CONST_CLICK_NO_FOCUS=1,CONST_CLICK_MOUSEDOWN=2,CONST_CLICK_STRANGE=3,JS_PRE_NAVIGATE_CPW=1,JS_PRE_LOGIN=2,JS_POST_NAVIGATE_CPW=3,JS_POST_LOGIN=4,JS_PRE_CPW=5,JS_POST_CPW=6,JS_PRE_ACCTMGMT=7,JS_POST_ACCTMGMT=8,JS_LOGIN_REVEAL=9,JS_VALIDATE_LOGIN_SUCCESS=10,JS_VALIDATE_CPW_SUCCESS=11,JS_LOGIN_SUBMIT=12,JS_FINISH=13,JS_PRE_CHALLENGE=14,JS_POST_CHALLENGE=15,JS_CHALLENGE_SUBMIT=16,JS_VALIDATE_CHALLENGE_SUCCESS=17,JS_BEGIN=18,JS_PRE_LOGOUT=19,JS_POST_LOGOUT=20,JS_LOGIN_ENTRY_SUBMIT=21,JS_PRE_LOGIN_ENTRY=22,JS_POST_LOGIN_ENTRY=23,JS_VALIDATE_LOGIN_ENTRY_SUCCESS=24,JS_PRE_DOCAPTCHA=25,JS_POST_DOCAPTCHA=26,DEFAULT_CLICK_DELAY=250,DEFAULT_FILL_DELAY=250,DEFAULT_SESSION_TIMEOUT=12e4,DEFAULT_VALIDATE_TIMEOUT=1e4,CLICK_RETRY_TIME=5e3,recipe_template={version:1,symbolic:"",login_url:"",acctmgmt_url:null,cpw_url:"",logout_url:"",login_entry_url:"",fakeui_loggedout_url:"",fakeui_loggedin_url:"",validate_timeout:5e3,field_info:[],jsfrags:[],cpw_delay:250,login_delay:250,acctmgmt_delay:250,login_reveal_delay:250,logout_reveal_delay:250,logout_delay:250,fill_field_delay:250,click_field_delay:250,trigger_cpw_delay:0,cpw_change_success_url:null,cpw_change_failure_url:null,login_failure_url:null,login_success_url:null,login_entry_failure_url:null,login_entry_success_url:null,challenge_invalidate_url:null,challenge_validate_url:null,click_flavor:CONST_CLICK_NOMINAL,generate_pref_overrides:null,reveal_login_js_delay:0,reveal_cpw_js_delay:0,navigate_acctmgmt_js_delay:0,postreveallogin_sleep:0,postacctmgmt_sleep:0,postrevealcpw_sleep:0,posttrigger_sleep:0,postlogout_sleep:0,start_delay:0,post_login_submit_delay:1100,post_js_begin_delay:5555,js_finish_delay:2e3,session_timeout:DEFAULT_SESSION_TIMEOUT,document_complete_timeout:0,proceed_on_interactive:0,click_on_fields_on_fill:0,fill_password_fields_via_keys:0},r_tesco={},r_netflix={},minimal_recipe={symbolic:"",login_url:"",field_info:[],generate_pref_overrides:{minlength:6}},telegraph={symbolic:"Daily Telegraph"},amex={symbolic:"American Express",field_info:[],jsfrag:[]},boa={symbolic:"Bank of America",login_url:"https://www.bankofamerica.com/sitemap/hub/signin.go",field_info:[{id_type:"TYPE_ID",id_value:"userId",id_function:"FN_LOGIN"},{id_type:"TYPE_ID",id_value:"password",id_function:"FN_PASSWORD"}],jsfrag:[]},capitalone={generate_pref_overrides:{mindigits:2,digits:1,special:0}},capitalone360={},testrig={symbolic:"Test",login_url:"http://www.netrot.net/~chang/form/formtest1.html",field_info:[{id_type:"TYPE_ID",id_value:"email",id_function:"FN_LOGIN"},{id_type:"TYPE_NAME",id_value:"password",id_function:"FN_PASSWORD"},{id_type:"TYPE_XPATH",id_value:"//input[@type='submit']",id_function:"FN_LOGIN_SUBMIT"},{id_type:"TYPE_ID",id_value:"email",id_function:"FN_IS_LOGGED_IN_NEGATION"},{id_type:"TYPE_XPATH",id_value:"//input[@type='submit']",id_function:"FN_CPW_SUBMIT"}],jsfrag:[],generate_pref_overrides:{mindigits:1,digits:1,special:0,minlength:6}};