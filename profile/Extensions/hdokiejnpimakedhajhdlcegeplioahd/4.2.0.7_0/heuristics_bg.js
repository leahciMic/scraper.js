function get_SAED_username_password_fields(e,n){function s(e){i&&console_log(e)}var a=[];if(!e)return a;n||(n={});var l=[],r=getBG(),t=null,f=null,i=!1;if(!e.save_all||!e.fields||0===e.fields.length)return[getusernamefromacct(e),getpasswordfromacct(e)];var d,E=[[50,50],[-50,-50],[-5,25],[5,-25],[10,-10],[-5,10],[5,-10],[-30,-30],[7,7],[1,-10],[-20,-20],[-20,-20]],_=null,p=null,o=new RegExp(get_ff_translation("ff_username_regexp")),u=new RegExp(get_ff_translation("ff_password_regexp")),R=new RegExp(get_ff_translation("ff_email_regexp")),m=new RegExp(get_ff_translation("ff_captcha_regexp")),O=new RegExp(get_ff_translation("ff_combineddummy_regexp")),S=new RegExp(get_ff_translation("ff_search_regexp")),C=[],g=e.fields.length;for(d=0;d<g;d++)C[d]={USCORE:0,PSCORE:0};for(d=0;d<g;d++){var c=e.fields[d].type,P=e.fields[d].value,U=e.fields[d].name;null!==P&&""!==P||(s(sprintf("[%d] %s VALUE:EMPTY",d,e.fields[d].name)),C[d].USCORE+=E[1][0],C[d].PSCORE+=E[1][1]),o.exec(U)&&(s(sprintf("[%d] %s NAME:USERNAME",d,e.fields[d].name)),C[d].USCORE+=E[4][0],C[d].PSCORE+=E[4][1]),u.exec(U)&&(s(sprintf("[%d] %s NAME:PASSWORD",d,e.fields[d].name)),C[d].USCORE+=E[5][0],C[d].PSCORE+=E[5][1]),R.exec(U)&&(s(sprintf("[%d] %s NAME:EMAIL",d,e.fields[d].name)),C[d].USCORE+=E[6][0],C[d].PSCORE+=E[6][1]),(m.exec(U)||O.exec(U)||S.exec(U))&&(s(sprintf("[%d] %s NAME:IGNORE",d,e.fields[d].name)),C[d].USCORE+=E[7][0],C[d].PSCORE+=E[7][1]),"password"==c?(s(sprintf("[%d] %s TYPE:PW_TYPE",d,e.fields[d].name)),null===f&&(C[d].PSCORE+=E[8][1],f=d),C[d].USCORE+=E[2][0],C[d].PSCORE+=E[2][1]):lp_in_array(c,["text","tel","email","url"])?(s(sprintf("[%d] %s TYPE:TEXT_TYPE",d,e.fields[d].name)),null===t&&(C[d].USCORE+=E[8][0],t=d),C[d].USCORE+=E[3][0],C[d].PSCORE+=E[3][1]):lp_in_array(c,["number"])?(s(sprintf("[%d] %s TYPE:HTML5TEXTISH",d,e.fields[d].name)),C[d].USCORE+=E[9][0],C[d].PSCORE+=E[9][1]):lp_in_array(c,["date","month","color","datetime","search","range","time","datetime-local","week"])?(s(sprintf("[%d] %s TYPE:HTML5NONTEXTISH",d,e.fields[d].name)),C[d].USCORE+=E[10][0],C[d].PSCORE+=E[10][1]):lp_in_array(c,["reset","button","image","file","submit"])&&(s(sprintf("[%d] %s TYPE:HTML4NONTEXTISH",d,e.fields[d].name)),C[d].USCORE+=E[11][0],C[d].PSCORE+=E[11][1]),"j_username"===U?_=d:"j_password"===U&&"password"==c&&(p=d)}null!==_&&null!==p&&(C[_].USCORE+=E[0][0],C[p].PSCORE+=E[0][1]);var v=0,x=-1/0,T=0,w=-1/0;for(d=0;d<g;d++)s(sprintf("FIELD %d name=%s U=%d/P=%d",d,e.fields[d].name,C[d].USCORE,C[d].PSCORE)),C[d].USCORE>x&&(x=C[d].USCORE,v=d),C[d].PSCORE>w&&(w=C[d].PSCORE,T=d);v===T&&g>1&&s("EDGE CASE TODO"),l=[];var h="";return h=is_encrypted_field(e.fields[v].type)?r.lpmdec_acct(e.fields[v].value,!0,e,r.g_shares):e.fields[v].value,null===h&&(h=""),s(sprintf("username: guessed %s/%s",e.fields[v].name,h)),l.push(h),h=is_encrypted_field(e.fields[T].type)?r.lpmdec_acct(e.fields[T].value,!0,e,r.g_shares):e.fields[T].value,null===h&&(h=""),s(sprintf("password: guessed %s/%s",e.fields[T].name,g_show_pw_in_logs?h:"<REDACTED>")),l.push(h),l}function value_is_masked(e,n){if(!e||"string"!=typeof e)return!1;var s=encodeURIComponent(e);return e.indexOf("***")>=0||s.indexOf("%E2%80%A2%E2%80%A2%E2%80%A2")>=0}function formdata_has_masked_values(e){if(!e)return!1;for(var n=void 0!==e?e.split("\n"):new Array,s=0;s<n.length;s++){var a=n[s],l=a.split("\t");if(4==l.length||5==l.length){var r=(decodeURIComponent(l[1]),decodeURIComponent(l[2])),t=decodeURIComponent(l[4]);if(value_is_masked(r)&&"notseen"!=t)return console_warn("detected masked field value: "+r),!0}}return!1}