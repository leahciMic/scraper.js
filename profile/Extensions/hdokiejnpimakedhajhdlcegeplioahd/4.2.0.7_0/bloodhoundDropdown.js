BloodhoundDropdown=function(o,e,t,n){TypeaheadDropdown.call(this,o,null,n),e.datumTokenizer=e.datumTokenizer||Bloodhound.tokenizers.whitespace,e.queryTokenizer=e.queryTokenizer||Bloodhound.tokenizers.whitespace,e.remote=e.remote||{},e.remote.transport=function(o,e,t){bg.LPServer.ajax($.extend(o,{success:function(o,t,n){e(o)},error:function(o,e,n){t(n)}}))},this.bloodhound=new Bloodhound(e),this.optionLabel=LPTools.getOption(t,"optionLabel",null),this.elementTemplate=LPTools.getOption(t,"elementTemplate",null),this.getValueFromDatum=LPTools.getOption(this.elementTemplate,"value",null),this.ignoreDatum=LPTools.getOption(t,"ignore",null),this.focused=!1,function(e){var t=$(o);t.unbind("focus"),t.bind("focus",function(){e.focused=!0}),t.bind("blur",function(){e.focused=!1})}(this)},BloodhoundDropdown.prototype=Object.create(TypeaheadDropdown.prototype),BloodhoundDropdown.constructor=BloodhoundDropdown,function(){BloodhoundDropdown.prototype.fireOnChange=function(o){null!==this.onChangeCallback&&this.options&&this.options[o]&&this.onChangeCallback(this.options[o].datum,o)},BloodhoundDropdown.prototype.getInputValue=function(o){if(this.getValueFromDatum)return this.getValueFromDatum(o.datum);TypeaheadDropdown.prototype.getInputValue.apply(this,arguments)},BloodhoundDropdown.prototype.processBloodhoundResponse=function(o,e){if(this.focused&&o.length>0){for(var t=[],n=0,i=o.length;n<i;++n){var u=o[n],l=this.bloodhound.identify(u);if(null===this.ignoreDatum||!this.ignoreDatum(l,u)){var s={value:l,label:this.optionLabel(u),datum:u};this.elementTemplate&&(s.element=this.elementTemplate.template(u)),t.push(s),0===n&&this.queryMatches(s,e)&&this.setHint(e,s)}}this.setOptions(t),e&&this.show(!0)}else this.hide(),this.clearHint()},BloodhoundDropdown.prototype.updateDropdown=function(o){!function(e){var t=function(t){e.hasMatches=t.length>0,e.processBloodhoundResponse(t,o)};e.bloodhound.search(o,t,t)}(this)}}();