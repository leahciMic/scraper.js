var IntroTour=function(e,t,r,n,o,s){"use strict";function u(){f.laterThisTour(),s.save(f.getOptions())}function i(){f.neverThisTour(),s.save(f.getOptions())}function c(){f.takeThisTour(),s.save(f.getOptions())}function a(){s.save(null)}function T(){f.makeLaterNowTours(),s.save(f.getOptions())}function l(){A&&(A.unSubscribeAction("later"),A.unSubscribeAction("never"),A.unSubscribeAction("start"),A.unSubscribeAction("close"),A.cleanup(),A=null)}function b(e){o.get(o.CLEAR_DATA).subscribeFirst(function(){e&&e.cleanup&&e.cleanup()})}function v(r){var n,a=this;s.migrateOldPrefs(),r?(f=new e,(n=f.getAvailableTour(r))&&(A=new t(n),b(a),A.startFlow(r))):(f=new e(s.retrieve()),s.save(f.getOptions()),n=f.getAvailableTour(),n?(A=new t(n),A.subscribeToAction("later",u),A.subscribeToAction("never",i),A.subscribeToAction("start",c),A.subscribeToAction("close",l),b(a),A.startFlow(r)):o.get(o.INTRO_TOURS_LOADED).publish())}var A,f;return{start:v,cleanup:l,neverThisTour:i,laterThisTour:u,takeThisTour:c,resetAllTours:a,makeLaterNowTours:T}}(IntroTourQueue,IntroTourFlow,IntroTourData,LPProxy,Topics,IntroTourPreferences);